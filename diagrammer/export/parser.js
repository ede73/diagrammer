var parser=function(){function t(t){this.setName=function(t){return void 0===t?this:T(this,"name",t)},this.getName=function(){return L(this,"name")},this.setColor=function(t){return void 0===t?this:T(this,"color",t)},this.getColor=function(){return L(this,"color")},this.setTextColor=function(t){return void 0===t?this:T(this,"textcolor",t)},this.getTextColor=function(){return L(this,"textcolor")},this.setUrl=function(t){return void 0===t?this:T(this,"url",t)},this.getUrl=function(){return L(this,"url")},this.label=t,this.setLabel=function(t){if(!t)return this;t=t.trim().replace(/"/gi,""),E("  TEST value("+t+") for color");var e=t.match(/^(#[A-Fa-f0-9]{6,6})(.*)$/);return null!==e&&3==e.length&&(this.setTextColor(e[1]),t=e[2].trim()),e=t.match(/\[([^\]]+)\](.*)$/),null!==e&&e.length>=3&&(this.setUrl(e[1]),t=e[2].trim()),T(this,"label",t)},this.getLabel=function(){return L(this,"label")},this.toString=function(){return"GraphObject"}}function e(){this.OBJECTS=[],this.setGenerator=function(t){return t&&(t=t.toLowerCase()),T(this,"generator",t)},this.getGenerator=function(){return L(this,"generator")},this.setVisualizer=function(t){return t&&(t=t.toLowerCase()),T(this,"visualizer",t)},this.getVisualizer=function(){return L(this,"visualizer")},this.setCurrentShape=function(t){return t&&(t=t.toLowerCase()),T(this,"shape",t)},this.getCurrentShape=function(){return L(this,"shape")},this.setDirection=function(t){return T(this,"direction",t)},this.getDirection=function(){return L(this,"direction")},this.setStart=function(t){return T(this,"start",t)},this.getStart=function(){return L(this,"start")},this.setEqual=function(t){return T(this,"equal",t)},this.getEqual=function(){return L(this,"equal")},this.setDefault=function(t,e){return E("Set ROOT "+t+" to "+e),T(this,t,e)},this.getDefault=function(t){return L(this,t)},this.toString=function(){return"GraphRoot"}}function r(t){this.name=t,this.OBJECTS=[],this.setEqual=function(t){return T(this,"equal",t)},this.getEqual=function(){return L(this,"equal")},this.setLinkLabel=function(t){return T(this,"linklabel",t)},this.getLinkLabel=function(){return L(this,"linklabel")},this.setDefault=function(t,e){return E("Set group "+t+" to "+e),T(this,t,e)},this.getDefault=function(t){return E("Get group "+t),L(this,t)},this.toString=function(){return"Group("+this.name+")"}}function i(t,e,r){this.linkType=t.trim(),this.left=e,this.right=r,this.toString=function(){return"Link(type:"+this.linkType+" as L:"+this.left.toString()+", R:"+this.right.toString()+",label="+this.getLabel()+")"}}function n(t,e){var r=e.slice(2,-1);if(-1!==r.indexOf(":")){var i=r.split(":");return E("GOT assignment "+i[0]+"="+i[1]),o(t)[i[0]]=i[1],i[1]}if(!o(t)[r])throw new Error("Variable "+r+" not defined");return o(t)[r]}function o(t){return t.VARIABLES||(t.VARIABLES={}),t.VARIABLES}function s(t){return t.GRAPHROOT||(E("no graphroot,init - in getGraphRoot",!0),void 0===t.result&&(t.result=function(t){console.log(t)}),E("...Initialize emptyroot "+t),t.CURRENTCONTAINER=[],t.LINKS=[],t.CONTAINER_EXIT=1,t.GRAPHROOT=new e,h(t,t.GRAPHROOT),E(!1)),t.GRAPHROOT}function a(t,e,i,n){if(e instanceof b){E("getList(node:"+e+",rhs:["+i+"])",!0);var o=[];return o.push(e),o.push(l(t,i).setLinkLabel(n)),E("return node:"+o,!1),o}if(e instanceof r){E("getList(group:["+e+"],rhs:"+i+")",!0);var o=[];return o.push(e),o.push(g(t,i).setLinkLabel(n)),E("return group:"+o,!1),o}return E("getList(lhs:["+e+"],rhs:"+i,!0),e.push(l(t,i).setLinkLabel(n)),E("return ["+e+"]",!1),e}function l(t,e,i){function n(t,e,i){if(e instanceof b)return i&&e.setStyle(i),e;if(e instanceof Array)return e;var n=function a(t,e){if(t.getName()==e)return t;for(var n in t.OBJECTS)if(t.OBJECTS.hasOwnProperty(n)){var o=t.OBJECTS[n];if(o instanceof b&&o.getName()==e)return i&&o.setStyle(i),o;if(o instanceof r){var s=a(o,e);if(void 0!=s)return s}}return void 0}(s(t),e);if(void 0!==n)return n;E("Create new node name="+e,!0);var o=new b(e,s(t).getCurrentShape());return i&&o.setStyle(i),u(t,"nodecolor",function(t){o.setColor(t)}),u(t,"nodetextcolor",function(t){o.setTextColor(t)}),E(!1),S(t,o)}E("getNode (name:"+e+",style:"+i+")",!0);var o=n(t,e,i);return E("  in getNode gotNode "+o),t.lastSeenNode=o,t.collectNextNode&&(E("Collect next node"),T(t.collectNextNode,"exitlink",e),t.collectNextNode=void 0),E(!1),o}function u(t,e,r){s(t);var i;for(var n in t.CURRENTCONTAINER)if(t.CURRENTCONTAINER.hasOwnProperty(n)){var o=t.CURRENTCONTAINER[n];if(i=o.getDefault(e),void 0!==i)return void 0!==r&&r(i),i}return i=s(t).getDefault(e),void 0!==i?(E("getDefaultAttribute got from graphroot"),void 0!==r&&r(i),i):void 0}function c(t){return s(t),t.CURRENTCONTAINER[t.CURRENTCONTAINER.length-1]}function h(t,e){return t.CURRENTCONTAINER.push(e),e}function f(t){if(t.CURRENTCONTAINER.length<=1)throw new Error("INTERNAL ERROR:Trying to exit ROOT container");return T(t.CURRENTCONTAINER.pop(),"exitnode",t.CONTAINER_EXIT++)}function p(t){return h(t,y(t))}function d(t){return f(t)}function g(t,e){if(e instanceof r)return e;E("getGroup() NEW GROUP:"+t+"/"+e,!0),void 0===t.GROUPIDS&&(t.GROUPIDS=1);var i=new r(t.GROUPIDS++);return E("push group "+i+" to "+t),S(t,i),u(t,"groupcolor",function(t){i.setColor(t)}),E(!1),i}function y(t,e){if(e instanceof N)return e;E("getSubGraph() NEW SubGraph:"+t+"/"+e,!0),void 0===t.SUBGRAPHS&&(t.SUBGRAPHS=1);var r=new N(t.SUBGRAPHS++);return E("push SubGraph "+r+" to "+t),S(t,r),E(!1),r}function m(t,e,n,o,s,a,l,c,h){var f,p;if(E(!0),o instanceof N&&void 0==o.getEntrance()&&o.setEntrance(n),n instanceof N&&void 0==n.getExit()&&n.setExit(o),n instanceof Array){for(E("getLink called with LHS array, type:"+e+" l:["+n+"] r:"+o+" inlineLinkLabel:"+s+" commonLinkLabel: "+a+" linkColor:"+l+" lcompass:"+c+" rcompass:"+h),p=0;p<n.length;p++)E("    1Get link "+n[p]),f=m(t,e,n[p],o,s,a,l,c,h);return E(!1),f}if(o instanceof Array){for(E("getLink called with RHS array, type:"+e+" l:"+n+" r:["+o+"] inlineLinkLabel:"+s+" commonLinkLabel: "+a+" linkColor:"+l+" lcompass:"+c+" rcompass:"+h),p=0;p<o.length;p++)E("    2Get link "+o[p]),f=m(t,e,n,o[p],s,a,l,c,h);return E(!1),f}if(E("getLink called type:"+e+" l:"+n+" r:"+o+" inlineLinkLabel:"+s+" commonLinkLabel: "+a+" linkColor:"+l+" lcompass:"+c+" rcompass:"+h),!(n instanceof b)&&!(n instanceof r)&!(n instanceof N))throw new Error("LHS not a Node,Group nor a SubGraph(LHS="+n+") RHS=("+o+")");if(!(o instanceof b||o instanceof r||o instanceof N))throw new Error("RHS not a Node,Group nor a SubGraph(LHS="+n+") RHS=("+o+")");E(" getLink type("+e+") l("+n+") r("+o+")");var d=new i(e,n,o);return c?T(d,"lcompass",c):L(n,"compass")&&T(d,"lcompass",L(n,"compass")),h?T(d,"rcompass",h):L(o,"compass")&&T(d,"rcompass",L(o,"compass")),u(t,"linkcolor",function(t){d.setColor(t)}),u(t,"linktextcolor",function(t){d.setTextColor(t)}),void 0!=a&&(d.setLabel(a),E("set commonLinkLabel "+a)),void 0!=s?(d.setLabel(s),E("set inlineLinkLabel "+s)):o instanceof b&&void 0!=a&&(d.setLabel(a),E("set commonLinkLabel "+a)),o instanceof b&&(tmp=o.getLinkLabel(),void 0!=tmp&&(d.setLabel(tmp),E("reset link label to "+tmp))),void 0!=l&&d.setColor(l),E(!1),O(t,d)}function O(t,e){return e instanceof Array?E("PUSH LINK ARRAY:"+e,!0):(E("PUSH LINK:"+e,!0),T(e,"container",c(t))),t.LINKS.push(e),E(!1),e}function S(t,e){return E("pushObject "+e+"to "+c(t),!0),c(t).OBJECTS.push(e),E(!1),e}function b(t,e){this.name=t,this.shape=e,this.image=void 0,this.style=void 0,this.setShape=function(t){return void 0===t?this:(t&&(t=t.toLowerCase()),T(this,"shape",t))},this.getShape=function(){return L(this,"shape")},this.setLinkLabel=function(t){return T(this,"linklabel",t)},this.getLinkLabel=function(){return $tmp=L(this,"linklabel"),T(this,"linklabel",void 0),$tmp},this.setStyle=function(t){return void 0===t?this:(t&&(t=t.toLowerCase()),T(this,"style",t))},this.getStyle=function(){return L(this,"style")},this.setImage=function(t){return void 0===t?this:T(this,"image",t)},this.getImage=function(){return L(this,"image")},this.toString=function(){return"Node(name:"+this.getName()+" color:"+k(this,"color",",color={0}")+" fmt:"+k(this,"label",",label={0}")+")"}}function v(t,e,r){return void 0==e||0==e?"":(e=e.toLowerCase(),e in t?" "+r.format(t[e])+" ":" "+r.format(t["default"])+" ")}function N(t){this.name=t,this.OBJECTS=[],this.isSubGraph=!0,this.setLinkLabel=function(t){return T(this,"linklabel",t)},this.getLinkLabel=function(){return L(this,"linklabel")},this.setDefault=function(t,e){return T(this,t,e)},this.setEntrance=function(t){return E("Set entrance to "+t),T(this,"entrance",t)},this.getEntrance=function(){return L(this,"entrance")},this.setExit=function(t){return E("Set exit to "+t),T(this,"exit",t)},this.getExit=function(){return L(this,"exit")},this.getDefault=function(t){return L(this,t)},this.toString=function(){return"SubGraph("+this.name+")"}}function E(t,e){if(1==VERBOSE&&t!==!1&&t!==!0){for(var r="",i=0;i<debugIndent;i++)r+="    ";console.log(r+t)}e===!0||t===!0?debugIndent++:(e===!1||t===!1)&&debugIndent--}function T(t,e,r){return t[e]=r,t}function L(t,e){return void 0===t[e]||0==t[e]?void 0:t[e]}function k(t,e,r,i){var n;if(e instanceof Array){for(var o in e)if(e.hasOwnProperty(o)&&(n=k(t,e[o],r,i),""!==n))return E("Return "+n),n;return""}return void 0==t[e]||0==t[e]?"":(n=r.format(t[e]),i&&i.push(n)," "+n+" ")}function x(t){t.result("actdiag{\n  default_fontsize = 14");var e,i=s(t);for(e in i.OBJECTS)if(i.OBJECTS.hasOwnProperty(e)){var n=i.OBJECTS[e];if(n instanceof r){t.result('  lane "'+n.getName()+'"{');for(var o in n.OBJECTS)if(n.OBJECTS.hasOwnProperty(o)){var a=n.OBJECTS[o],l=k(a,"color",',color="{0}"')+v(Te.actdiag,a.shape,",shape={0}")+k(a,"label",',label="{0}"');""!=l.trim()&&(l="["+l.trim().substring(1)+"]"),t.result("    "+a.getName()+l+";")}t.result("  }")}else{var u=k(n,"style",',style="{0}"');""!=u&&null==u.match(/(dotted|dashed|solid)/)&&(u="");var c=k(n,"color",',color="{0}"')+k(n,"image",',background="icons{0}"')+u+v(Te.actdiag,n.shape,",shape={0}")+k(n,"label",',label="{0}"');""!=c.trim()&&(c="["+c.trim().substring(1)+"]"),t.result("  "+n.getName()+c+";")}}for(e in t.LINKS)if(t.LINKS.hasOwnProperty(e)){var h=t.LINKS[e],f="";-1!==h.linkType.indexOf(".")?f+=',style="dotted" ':-1!==h.linkType.indexOf("-")&&(f+=',style="dashed" ');var p=k(h,"label",',label = "{0}"'+k(h,["color","textcolor"],'textcolor="{0}"')),d=k(h,"color",',color="{0}"');f+=p+d,f=f.trim(),","==f.substring(0,1)&&(f=f.substring(1).trim()),""!=f&&(f="["+f+"]"),t.result("  "+h.left.getName()+" -> "+h.right.getName()+f+";")}t.result("}")}function C(t){function e(t){if(""==t.trim())return"";for(var e="",r=0;i>r;r++)e+="    ";return e+t}var i=0;t.result(e("{result:")),i++;var n=s(t);n.getVisualizer()&&t.result(e(JSON.stringify({visualizer:n.getVisualizer()}))),n.getDirection()&&t.result(e(JSON.stringify({direction:n.getDirection()}))),n.getStart()&&t.result(e(JSON.stringify({start:n.getStart()}))),n.getEqual()&&t.result(e(JSON.stringify({equal:n.getEqual()})));!function u(n){for(var o in n.OBJECTS)if(n.OBJECTS.hasOwnProperty(o)){var s=n.OBJECTS[o];if(s instanceof r){(function(r){var n=JSON.parse(JSON.stringify(r));n.OBJECTS=void 0,t.result(e(JSON.stringify({group:n}))),i++,u(r),i--})(s)}else if(s instanceof N){(function(r){var n=JSON.parse(JSON.stringify(r));n.OBJECTS=void 0,t.result(e(JSON.stringify({subgraph:n}))),i++,u(r),i--})(s)}else{if(!(s instanceof b))throw new Error("Not a node nor a group, NOT SUPPORTED");t.result(e(JSON.stringify({node:s})))}}}(n);for(var o in t.LINKS)if(t.LINKS.hasOwnProperty(o)){var a=t.LINKS[o],l=JSON.parse(JSON.stringify(a));l.container.OBJECTS=void 0,l.container.label=void 0,l.container.conditional=void 0,t.result(e(JSON.stringify(l)))}--i,t.result(e("}"))}function w(t){t.result("blockdiag{\n default_fontsize = 14");var e=s(t);t.result("portrait"===e.getDirection()?"  orientation=portrait":"  orientation=landscape");var i,n=e.getStart();for(i in e.OBJECTS)if(e.OBJECTS.hasOwnProperty(i)){var o=e.OBJECTS[i];if(o instanceof r){t.result('  group "'+o.getLabel()+'"{'),t.result(k(o,"color",'   color="{0}"')),t.result(k(o,"label",'   label="{0}"')),void 0!==n&&""!=n.trim()&&(n="["+n.trim().substring(1)+"]");for(var a in o.OBJECTS)if(o.OBJECTS.hasOwnProperty(a)){var l=o.OBJECTS[a];n=k(l,"color",',color="{0}"')+v(Te.blockdiag,l.shape,",shape={0}")+k(l,"label",',label="{0}"'),""!=n.trim()&&(n="["+n.trim().substring(1)+"]"),t.result("    "+l.getName()+n+";")}t.result("  }")}else{var u=k(o,"style",',style="{0}"');""!=u&&null==u.match(/(dotted|dashed|solid)/)&&(u="");var c=k(o,"color",',color="{0}"')+k(o,"image",',background="icons{0}"')+u+v(Te.blockdiag,o.shape,',shape="{0}"')+k(o,"label",',label="{0}"');""!=c.trim()&&(c="["+c.trim().substring(1)+"]"),t.result("  "+o.getName()+c+";")}}for(i in t.LINKS)if(t.LINKS.hasOwnProperty(i)){var h=t.LINKS[i],f="";-1!==h.linkType.indexOf(".")?f+=',style="dotted" ':-1!==h.linkType.indexOf("-")&&(f+=',style="dashed" ');var p=k(h,"label",',label = "{0}"'+k(h,["color","textcolor"],'textcolor="{0}"')),d=k(h,"color",',color="{0}"');f+=p+d,f=f.trim(),","==f.substring(0,1)&&(f=f.substring(1).trim()),""!=f&&(f="["+f+"]"),t.result("  "+h.left.getName()+" -> "+h.right.getName()+f+";")}t.result("}")}function _(t){function e(t){if(""==t.trim())return"";for(var e="",r=0;i>r;r++)e+="    ";return e+t}var i=0;t.result(e("{result:")),i++;var n=s(t);n.getVisualizer()&&t.result(e(JSON.stringify({visualizer:n.getVisualizer()}))),n.getDirection()&&t.result(e(JSON.stringify({direction:n.getDirection()}))),n.getStart()&&t.result(e(JSON.stringify({start:n.getStart()}))),n.getEqual()&&t.result(e(JSON.stringify({equal:n.getEqual()})));!function u(n){for(var o in n.OBJECTS)if(n.OBJECTS.hasOwnProperty(o)){var s=n.OBJECTS[o];if(s instanceof r){(function(r){var n=JSON.parse(JSON.stringify(r));n.OBJECTS=void 0,t.result(e(JSON.stringify({group:n}))),i++,u(r),i--})(s)}else{if(!(s instanceof b))throw new Error("Not a node nor a group, NOT SUPPORTED");t.result(e(JSON.stringify({node:s})))}}}(n);for(var o in t.LINKS)if(t.LINKS.hasOwnProperty(o)){var a=t.LINKS[o],l=JSON.parse(JSON.stringify(a));l.container.OBJECTS=void 0,l.container.label=void 0,l.container.conditional=void 0,t.result(e(JSON.stringify(l)))}--i,t.result(e("}"))}function I(t){function e(t){if(""==t.trim())return"";for(var e="",r=0;o>r;r++)e+="  ";return(e+t).trim()}function i(e){for(var r in t.LINKS)if(t.LINKS.hasOwnProperty(r)){var i=t.LINKS[r];for(var n in e.OBJECTS)if(e.OBJECTS.hasOwnProperty(n)){var o=e.OBJECTS[n];if(o==i.left)return o}}return void 0}function n(e){var r=void 0;for(var i in t.LINKS)if(t.LINKS.hasOwnProperty(i)){var n=t.LINKS[i];for(var o in e.OBJECTS)if(e.OBJECTS.hasOwnProperty(o)){var s=e.OBJECTS[o];s==n.left&&(r=s),s==n.right&&(r=s)}}return r}var o=0,a=function(r){var i=[],n=[];k(r,"color",'fillcolor="{0}"',i),k(r,"color","filled",n),k(r,"style","{0}",n);var o=L(r,"url");o&&i.push('"[['+o.trim()+']]"'),n.length>0&&i.push(-1!==n.join("").indexOf("singularity")?"circle":n.join(",")),k(r,"image",'image="icons{0}"',i),k(r,"textcolor",'fontcolor="{0}"',i),k(r,"label",'"{0}"',i);var s="";i.length>0&&(s=i.join(",")),t.result(e("t_"+r.getName()+" "+r.getName()+" "+s))},l=function(r){var i=[];k(r,"color",'"{0}"',i);var n=v(Te.digraph,r.shape,"{0}");i.push(n?n:"circle");var o="";i.length>0&&(o=i.join("|")),t.result(e("(type t_"+r.getName()+o+")"))},u=s(t);u.getVisualizer()&&t.result("/* render:"+u.getVisualizer()+"*/"),t.result("GRAPH:"),o++,t.result("fff");var c=function(t){for(var e in t.OBJECTS)if(t.OBJECTS.hasOwnProperty(e)){var i=t.OBJECTS[e];i instanceof r&&(0==i.OBJECTS.length?i.OBJECTS.push(new b("invis_"+i.getName()).setStyle("invis")):c(i))}}(u.OBJECTS);t.result("zzz"),t.result("xxx"),t.result("+++");!function(t){for(var e in t.OBJECTS)if(t.OBJECTS.hasOwnProperty(e)){var i=t.OBJECTS[e];if(i instanceof r);else{if(!(i instanceof b))throw new Error("Not a node nor a group, NOT SUPPORTED");l(i)}}}(u);t.result("----");{var h=void 0,f=void 0;!function C(s){for(var l in s.OBJECTS)if(s.OBJECTS.hasOwnProperty(l)){var u=s.OBJECTS[l];if(u instanceof r){var c=L(u,"conditional");(function(r){if(E(JSON.stringify(r)),t.result(e("subgraph cluster_"+r.getName()+" {")),r.isSubGraph&&t.result("graph[style=invis];"),o++,r.getLabel()&&t.result(e(k(r,"label",'   label="{0}";'))),void 0!==r.getColor()&&(t.result(e("style=filled;")),t.result(e(k(r,"color",'   color="{0}";\n')))),o++,C(r),o--,o--,t.result(e("}//3end of "+r.getName()+" "+c)),c)if(t.result(e("//COND "+r.getName()+" "+c)),"endif"==c){var s=L(r,"exitlink");s&&(t.result(e(h+"->"+s+"[color=red];")),t.result(e(f+"->"+s+";")))}else{var a="entry"+L(r,"exitnode");f||(f="endif"+L(r,"exitnode"),t.result(e(f+'[shape=circle,label="",width=0.01,height=0.01];'))),t.result(e(a+'[shape=diamond,fixedsize=true,width=1,height=1,label="'+r.getLabel()+'"];')),"if"==c&&t.result(e(L(r,"entrylink").getName()+"->"+a+";"));var l=i(r),u=n(r);h&&t.result(e(h+"->"+a+'[label="NO",color=red];')),t.result(e(a+"->"+l.getName()+'[label="YES",color=green,lhead=cluster_'+r.getName()+"];")),t.result(e(u.getName()+"->"+f+'[label=""];')),h=a}})(u)}else{if(!(u instanceof b))throw new Error("Not a node nor a group, NOT SUPPORTED");a(u)}}}(u)}t.result("//links start");for(var p in t.LINKS)if(t.LINKS.hasOwnProperty(p)){var d=t.LINKS[p],g=[],y=L(d,"label");y&&(-1!==y.indexOf("::")?(y=y.split("::"),g.push('label="'+y[0].trim()+'"'),g.push('xlabel="'+y[1].trim()+'"')):g.push('label="'+y.trim()+'"'));var m=L(d,"url");m&&g.push('URL="'+m.trim()+'"'),k(d,"color",'color="{0}"',g),k(d,["textcolor","color"],'fontcolor="{0}"',g);var O,S=d.right,N=d.left;if(S instanceof r&&(S.isSubGraph||g.push(" lhead=cluster_"+S.getName()),S=S.OBJECTS[0]),N instanceof r&&(N.isSubGraph||g.push(" ltail=cluster_"+N.getName()),N=N.OBJECTS[0]),-1!==d.linkType.indexOf(".")?g.push('style="dotted"'):-1!==d.linkType.indexOf("-")&&g.push('style="dashed"'),-1!==d.linkType.indexOf("/")&&g.push('arrowhead="tee"'),-1!==d.linkType.indexOf("<")&&-1!==d.linkType.indexOf(">"))O="->",g.push("dir=both");else if(-1!==d.linkType.indexOf("<")){var T=N;N=S,S=T,O="->"}else-1!==d.linkType.indexOf(">")?O="->":(O="->",g.push("dir=none"));var x="";g.length>0&&(x="["+g.join(",")+"]"),t.result(e(N.getName()+k(d,"lcompass","{0}").trim()+O+S.getName()+k(d,"rcompass","{0}").trim()+x+";"))}t.result("}")}function R(t){function e(t){if(""==t.trim())return"";for(var e="",r=0;o>r;r++)e+="  ";return e+t}function i(e){for(var r in t.LINKS)if(t.LINKS.hasOwnProperty(r)){var i=t.LINKS[r];for(var n in e.OBJECTS)if(e.OBJECTS.hasOwnProperty(n)){var o=e.OBJECTS[n];if(o==i.left)return o}}return void 0}function n(e){var r=void 0;for(var i in t.LINKS)if(t.LINKS.hasOwnProperty(i)){var n=t.LINKS[i];for(var o in e.OBJECTS)if(e.OBJECTS.hasOwnProperty(o)){var s=e.OBJECTS[o];s==n.left&&(r=s),s==n.right&&(r=s)}}return r}var o=0,a=function(r){var i=[],n=[];k(r,"color",'fillcolor="{0}"',i),k(r,"color","filled",n),k(r,"style","{0}",n);var o=L(r,"url");o&&i.push('URL="'+o.trim()+'"'),n.length>0&&(-1!==n.join("").indexOf("singularity")?(i.push('shape="circle"'),i.push('label=""'),i.push("width=0.01"),i.push("weight=0.01")):i.push('style="'+n.join(",")+'"')),k(r,"image",'image="icons{0}"',i),k(r,"textcolor",'fontcolor="{0}"',i);var s=v(Te.digraph,r.shape,'shape="{0}"');s&&i.push(s),k(r,"label",'label="{0}"',i);var a="";i.length>0&&(a="["+i.join(",")+"]"),t.result(e(r.getName()+a+";"))},u=s(t);u.getVisualizer()&&t.result("/* render:"+u.getVisualizer()+"*/"),t.result("digraph {"),o++,t.result(e("compound=true;")),t.result("portrait"===u.getDirection()?e("rankdir=LR;"):e("rankdir=TD;"));var c=u.getStart();if(void 0!=c&&""!=c){var h=l(t,c);a(h),t.result(e("//startnode setup\n  {rank = same;null} {rank = same; "+c+'}\n  null [shape=plaintext, label=""];\n  '+c+"[shape=doublecircle];\n  null->"+c+";\n"))}if(void 0!=u.getEqual()&&u.getEqual().length>0){t.result(e("{rank=same;"));for(var f=0;f<u.getEqual().length;f++)t.result(e(u.getEqual()[f].getName()+";"));t.result("}")}{var p=function(t){for(var e in t.OBJECTS)if(t.OBJECTS.hasOwnProperty(e)){var i=t.OBJECTS[e];i instanceof r&&(0==i.OBJECTS.length?i.OBJECTS.push(new b("invis_"+i.getName()).setStyle("invis")):p(i))}}(u.OBJECTS),d=void 0,g=void 0;!function I(s){for(var l in s.OBJECTS)if(s.OBJECTS.hasOwnProperty(l)){var u=s.OBJECTS[l];if(u instanceof r){var c=L(u,"conditional");(function(r){if(E(JSON.stringify(r)),t.result(e("subgraph cluster_"+r.getName()+" {")),r.isSubGraph&&t.result("graph[style=invis];"),o++,r.getLabel()&&t.result(e(k(r,"label",'   label="{0}";'))),void 0!==r.getColor()&&(t.result(e("style=filled;")),t.result(e(k(r,"color",'   color="{0}";\n')))),o++,I(r),o--,o--,t.result(e("}//end of "+r.getName()+" "+c)),c)if(t.result(e("//COND "+r.getName()+" "+c)),"endif"==c){var s=L(r,"exitlink");s&&(t.result(e(d+"->"+s+"[color=red];")),t.result(e(g+"->"+s+";")))}else{var a="entry"+L(r,"exitnode");g||(g="endif"+L(r,"exitnode"),t.result(e(g+'[shape=circle,label="",width=0.01,height=0.01];'))),t.result(e(a+'[shape=diamond,fixedsize=true,width=1,height=1,label="'+r.getLabel()+'"];')),"if"==c&&t.result(e(L(r,"entrylink").getName()+"->"+a+";"));var l=i(r),u=n(r);d&&t.result(e(d+"->"+a+'[label="NO",color=red];')),t.result(e(a+"->"+l.getName()+'[label="YES",color=green,lhead=cluster_'+r.getName()+"];")),t.result(e(u.getName()+"->"+g+'[label=""];')),d=a}})(u)}else{if(!(u instanceof b))throw new Error("Not a node nor a group, NOT SUPPORTED");a(u)}}}(u)}t.result("//links start");for(var y in t.LINKS)if(t.LINKS.hasOwnProperty(y)){var m=t.LINKS[y],O=[],S=L(m,"label");S&&(-1!==S.indexOf("::")?(S=S.split("::"),O.push('label="'+S[0].trim()+'"'),O.push('xlabel="'+S[1].trim()+'"')):O.push('label="'+S.trim()+'"'));var N=L(m,"url");N&&O.push('URL="'+N.trim()+'"'),k(m,"color",'color="{0}"',O),k(m,["textcolor","color"],'fontcolor="{0}"',O);var T,x=m.right,C=m.left;if(x instanceof r&&(x.isSubGraph||O.push(" lhead=cluster_"+x.getName()),x=x.OBJECTS[0]),C instanceof r&&(C.isSubGraph||O.push(" ltail=cluster_"+C.getName()),C=C.OBJECTS[0]),-1!==m.linkType.indexOf(".")?O.push('style="dotted"'):-1!==m.linkType.indexOf("-")&&O.push('style="dashed"'),-1!==m.linkType.indexOf("/")&&O.push('arrowhead="tee"'),-1!==m.linkType.indexOf("<")&&-1!==m.linkType.indexOf(">"))T="->",O.push("dir=both");else if(-1!==m.linkType.indexOf("<")){var w=C;C=x,x=w,T="->"}else-1!==m.linkType.indexOf(">")?T="->":(T="->",O.push("dir=none"));var _="";O.length>0&&(_="["+O.join(",")+"]"),t.result(e(C.getName()+k(m,"lcompass","{0}").trim()+T+x.getName()+k(m,"rcompass","{0}").trim()+_+";"))}t.result("}")}function J(t){t.result("msc {");var e,i,n=s(t),o=!1;for(e in n.OBJECTS)if(n.OBJECTS.hasOwnProperty(e)){var a=n.OBJECTS[e];if(a instanceof r){t.result(" /*"+a.getName()+k(a,"label"," {0}*/"));for(var l in a.OBJECTS)if(a.OBJECTS.hasOwnProperty(l)){var u=a.OBJECTS[l];i=k(u,"color",',color="{0}"')+k(u,"style",",style={0}")+k(u,"label",',label="{0}"'),""!=i.trim()&&(i="["+i.trim().substring(1)+"]"),t.result((o?",":"")+"    "+u.getName()+i),o=!0}}else a instanceof b&&(i=k(a,"color",',textbgcolor="{0}"')+k(a,"style",",style={0}")+k(a,"label",',label="{0}"'),""!=i.trim()&&(i="["+i.trim().substring(1)+"]"),t.result((o?",":"")+"  "+a.getName()+i),o=!0)}t.result(";");var c=1;for(e in t.LINKS)if(t.LINKS.hasOwnProperty(e)){var h=t.LINKS[e],f="",p=h.right,d=h.left;p instanceof r&&(f+=" lhead=cluster_"+p.getName(),p=p.OBJECTS[0]);var g=p.getName(),y=!1,m=!1,O=!1;-1!==h.linkType.indexOf(".")?y=!0:-1!==h.linkType.indexOf("-")?m=!0:-1!==h.linkType.indexOf("/")&&(O=!0);var S=!1,v=[],N=L(h,"label"),E=L(h,"color"),T=L(h,"url"),x="";if(T&&v.push('URL="'+T+'"'),E&&v.push('linecolor="'+E+'"'),N&&(-1!==N.indexOf("::")?(N=N.split("::"),x=N[1].trim(),v.push('label="'+N[0].trim()+'"')):v.push('label="'+N.trim()+'"')),v.push('id="'+c++ +'"'),-1!==h.linkType.indexOf("<")&&-1!==h.linkType.indexOf(">"))d==p?(f="->",g="*"):(f="<=>",S=!0);else if(-1!==h.linkType.indexOf("<")){var C=d;d=p,p=C,f=y?">>":m?"->":O?"-x":"=>",g=p.getName()}else if(-1!==h.linkType.indexOf(">"))f=y?">>":m?"->":O?"-x":"=>";else{if(y){E&&v.push('textcolor="'+E+'"'),t.result("...["+v.join(",")+"];");continue}if(m){E&&v.push('textcolor="'+E+'"'),t.result("---["+v.join(",")+"];");continue}t.result("ERROR: SHOULD NOT HAPPEN")}t.result(d.getName()+f+g+"["+v.join(",")+"];"),""!=x&&t.result(p.getName()+" abox "+p.getName()+'[label="'+x+'"];')}t.result("}")}function A(t){t.result("nwdiag{\n default_fontsize = 16\n");var e,i,n=s(t);for(e in n.OBJECTS)if(n.OBJECTS.hasOwnProperty(e)){var o=n.OBJECTS[e];if(o instanceof r){t.result("  network "+o.getName()+"{"),""!=o.getLabel()&&t.result('    address="'+o.getLabel()+'"');for(var a in o.OBJECTS)if(o.OBJECTS.hasOwnProperty(a)){var l=o.OBJECTS[a];i=k(l,"color",',color="{0}"')+v(Te.actdiag,l.shape,',shape="{0}"')+k(l,"label",',address="{0}"'),""!=i.trim()&&(i="["+i.trim().substring(1)+"]"),t.result("    "+l.getName()+i+";")}for(var u in t.LINKS)if(t.LINKS.hasOwnProperty(u)){var c=t.LINKS[u];i=k(c,"label",'[address="{0}"]'),c.left==o&&t.result("  "+c.right.getName()+i+";"),c.right==o&&t.result("  "+c.left.getName()+i+";")}t.result("  }")}else i=k(o,"color",',color="{0}"')+k(o,"image",',background="icons{0}"')+v(Te.actdiag,o.shape,',shape="{0}"')+k(o,"label",',label="{0}"'),""!=i.trim()&&(i="["+i.trim().substring(1)+"]"),t.result("    "+o.getName()+i+";")}for(e in t.LINKS)if(t.LINKS.hasOwnProperty(e)){var h=t.LINKS[e];h.left instanceof r||h.right instanceof r||t.result(h.left.getName()+" -- "+h.right.getName()+";")}t.result("}")}function P(t){function e(t){if(""==t.trim())return"";for(var e="",r=0;i>r;r++)e+="  ";return e+t}var i=0,n=function(r){var i=[],n=[];k(r,"style","{0}",n),n.length>0&&(-1!==n.join("").indexOf("singularity")?(i.push('shape="circle"'),i.push('label=""'),i.push("width=0.01"),i.push("weight=0.01")):i.push('style="'+n.join(",")+'"')),k(r,"image",'image="icons{0}"',i),k(r,"textcolor",'fontcolor="{0}"',i);var o=v(Te.digraph,r.shape,'shape="{0}"');o&&i.push(o);var s="";i.length>0&&(s="["+i.join(",")+"]"),t.result(e("participant "+k(r,"label",'"{0}" as')+" "+r.getName()+s))},o=s(t);o.getVisualizer()&&t.result("/* render:"+o.getVisualizer()+"*/"),t.result("@startuml"),t.result("autonumber");var a=o.getStart();if(void 0!=a&&""!=a){var u=l(t,a);n(u,!1)}{var c=function(i,n){for(var o in t.LINKS)if(t.LINKS.hasOwnProperty(o)){var s=t.LINKS[o];if(!s.printed){if(s.container!==i)break;s.printed=!0;var a="",l=L(s,"label");l&&-1!==l.indexOf("::")&&(l=l.split("::"),a=l[1].trim(),l=l[0].trim());var u,c=k(s,"color","[{0}]").trim(),h=s.right,f=s.left;h instanceof r&&(h=h.OBJECTS[0]),f instanceof r&&(f=f.OBJECTS[0]),-1!==s.linkType.indexOf("/");var p=!1,d=!1;-1!==s.linkType.indexOf(".")?p=!0:-1!==s.linkType.indexOf("-")?d=!0:-1!==s.linkType.indexOf("/");var g=!1;if(-1!==s.linkType.indexOf("<")&&-1!==s.linkType.indexOf(">"))u=(p?"-":"")+"-"+c+">",g=!0;else if(-1!==s.linkType.indexOf("<")){var y=f;f=h,h=y,u=(p?"-":"")+"-"+c+">"}else if(-1!==s.linkType.indexOf(">"))u=(p?"-":"")+"-"+c+">";else{if(p){t.result(k(s,"label","...{0}..."));continue}if(d){t.result(k(s,"label","=={0}=="));continue}u="-"+c+">"}var m="";l=l?":"+l:"",t.result(e(f.getName()+u+h.getName()+m+l)),g&&t.result(e(h.getName()+u+f.getName()+m+l)),n?h.active?(f.active=!1,t.result(e("deactivate "+f.getName()))):(t.result(e("activate "+h.getName())),h.active=!0):f.active&&(f.active=!1,t.result(e("deactivate "+f.getName()))),""!=a&&(t.result(e("note over "+h.getName())),t.result(a.replace(/\\n/g,"\n")),t.result(e("end note")))}}};!function h(o,s){var a,l;for(a in o.OBJECTS)o.OBJECTS.hasOwnProperty(a)&&(l=o.OBJECTS[a],l instanceof b&&n(l,s));c(o,s);for(a in o.OBJECTS)if(o.OBJECTS.hasOwnProperty(a))if(l=o.OBJECTS[a],l instanceof r){(function(r){E(JSON.stringify(r));var n=L(r,"conditional"),o=L(r,"isSubGraph");n?("if"==n?n="alt":"elseif"==n?n="else":"else"==n?n="else":"endif"==n&&(n="end"),t.result(e(n+" "+r.getLabel()))):n="",void 0!==r.getColor()&&(t.result(e("style=filled;")),t.result(e(k(r,"color",'   color="{0}";\n')))),i++,h(r,o),c(r),i--})(l)}else if(!l instanceof b)throw new Error("Not a node nor a group, NOT SUPPORTED")}(o,!1)}c(o),t.result("@enduml")}function B(t){t.result("seqdiag {"),t.result("autonumber = True;"),t.result(" activation = none;");var e,i=s(t);for(e in i.OBJECTS)if(i.OBJECTS.hasOwnProperty(e)){var n=i.OBJECTS[e];if(n instanceof r){t.result(" /*"+n.getName()+k(n,"label"," {0}*/"));for(var o in n.OBJECTS)if(n.OBJECTS.hasOwnProperty(o)){var a=n.OBJECTS[o],l=k(a,"style",",style={0}")+k(a,"label",',label="{0}"');""!=l.trim()&&(l="["+l.trim().substring(1)+"]"),t.result(a.getName()+l+";")}}else if(n instanceof b){var u=k(n,"style",",style={0}")+k(n,"label",',label="{0}"')+k(n,"color",',color="{0}"');""!=u.trim()&&(u="["+u.trim().substring(1)+"]"),t.result(n.getName()+u+";")}}for(e in t.LINKS)if(t.LINKS.hasOwnProperty(e)){var c=t.LINKS[e],h=[],f="",p=c.right,d=c.left,g=L(c,"color");g&&h.push('color="'+g+'"');var y=L(c,"label");y&&(-1!==y.indexOf("::")?(y=y.split("::"),h.push('note="'+y[1].trim()+'"'),h.push('label="'+y[0].trim()+'"')):h.push('label="'+y.trim()+'"')),p instanceof r&&(f+=" lhead=cluster_"+p.getName(),p=p.OBJECTS[0]);var m=p.getName(),O=!1,S=!1;if(-1!==c.linkType.indexOf(".")?O=!0:-1!==c.linkType.indexOf("-")?S=!0:-1!==c.linkType.indexOf("/")&&h.push("failed"),-1!==c.linkType.indexOf("<")&&-1!==c.linkType.indexOf(">")){if(p==d){t.result(k(c,"label","===BROADCAST:{0}==="));continue}f="=>"}else if(-1!==c.linkType.indexOf("<"))f=O?"<--":S?"<<--":"<-",m=p.getName();else if(-1!==c.linkType.indexOf(">"))f=O?"-->":S?"-->>":"->";else{if(O){t.result(k(c,"label","...{0}..."));continue}if(S){t.result(k(c,"label","==={0}==="));continue}t.result("ERROR: SHOULD NOT HAPPEN")}t.result(d.getName()+" "+f+" "+m+"["+h.join(",")+"];")}t.result("}")}function U(){this.yy={}}var G=function(t,e,r,i){for(r=r||{},i=t.length;i--;r[t[i]]=e);return r},D=[10,14],K=[2,38],$=[1,3],q=[1,25],z=[1,27],V=[1,4],H=[1,5],X=[1,6],j=[1,7],M=[1,8],F=[1,9],Z=[1,10],Y=[1,11],Q=[1,12],W=[1,13],te=[1,14],ee=[1,15],re=[1,16],ie=[1,17],ne=[1,18],oe=[1,19],se=[1,20],ae=[1,21],le=[1,22],ue=[1,29],ce=[1,5,8,10,14,19,22,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54],he=[1,40],fe=[1,41],pe=[7,8,30,51],de=[1,5,8,10,14,19,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55],ge=[1,52],ye=[1,5,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55],me=[1,5,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,51,52,53,54,55,56,57],Oe=[30,51],Se=[10,14,54],be=[7,8,10,14,19,22,54,57],ve=[10,14,19,22,54,57],Ne=[10,14,19,22,54],Ee={trace:function(){},yy:{},symbols_:{error:2,S:3,graphContent:4,EOF:5,colorOrVariable:6,COLOR:7,VARIABLE:8,shapeOrVariable:9,SHAPES:10,readNodeAttrs:11,readNodeAttrs_option0:12,readNodeAttrs_option1:13,NAME:14,readNodeAttrs_option2:15,readNodeAttrs_option3:16,readNodeAttrs_option4:17,nodeGroupListOrAttrs:18,OPAREN:19,LISTSEP:20,nodeGroupListOrAttrs_option0:21,CPAREN:22,readEvents:23,readEvents_option0:24,EVENT:25,readEvents_option1:26,readEvents_option2:27,readEvents_option3:28,readEvents_option4:29,LABEL:30,SHAPE:31,EQUAL:32,LANDSCAPE:33,GENERATOR:34,VISUALIZER:35,PORTRAIT:36,COMMENT:37,NODE_COLOR:38,NODETEXT_COLOR:39,LINK_COLOR:40,LINKTEXT_COLOR:41,GROUP_COLOR:42,IF:43,ELSEIF:44,ELSE:45,ENDIF:46,GROUP:47,graphContent_option0:48,graphContent_option1:49,graphContent_option2:50,GROUP_DECLARATION_END:51,GROUP_END:52,START:53,STYLES:54,COMPASS:55,IMAGE:56,INLINE_STRING:57,GROUPNAME:58,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"COLOR",8:"VARIABLE",10:"SHAPES",14:"NAME",19:"OPAREN",20:"LISTSEP",22:"CPAREN",25:"EVENT",30:"LABEL",31:"SHAPE",32:"EQUAL",33:"LANDSCAPE",34:"GENERATOR",35:"VISUALIZER",36:"PORTRAIT",37:"COMMENT",38:"NODE_COLOR",39:"NODETEXT_COLOR",40:"LINK_COLOR",41:"LINKTEXT_COLOR",42:"GROUP_COLOR",43:"IF",44:"ELSEIF",45:"ELSE",46:"ENDIF",47:"GROUP",51:"GROUP_DECLARATION_END",52:"GROUP_END",53:"START",54:"STYLES",55:"COMPASS",56:"IMAGE",57:"INLINE_STRING",58:"GROUPNAME"},productions_:[0,[3,1],[3,2],[3,2],[6,1],[6,1],[9,1],[9,1],[11,6],[18,1],[18,4],[18,1],[18,1],[23,8],[23,2],[23,1],[4,1],[4,2],[4,2],[4,2],[4,1],[4,2],[4,2],[4,1],[4,1],[4,2],[4,2],[4,2],[4,2],[4,2],[4,1],[4,1],[4,1],[4,1],[4,5],[4,1],[4,2],[4,1],[12,0],[12,1],[13,0],[13,1],[15,0],[15,1],[16,0],[16,1],[17,0],[17,1],[21,0],[21,1],[24,0],[24,1],[26,0],[26,1],[27,0],[27,1],[28,0],[28,1],[29,0],[29,1],[48,0],[48,1],[49,0],[49,1],[50,0],[50,1]],performAction:function(t,e,r,i,o,u){var y=u.length-1;
switch(o){case 1:case 4:case 7:case 11:this.$=u[y];break;case 2:this.$=u[y-1]+u[y];break;case 3:var O=s(i).getGenerator();return i.OUTPUT&&(O=i.OUTPUT),i.OUTPUT||(i.OUTPUT=O),i.VISUALIZER||(i.VISUALIZER=s(i).getVisualizer()),i.VISUALIZER||(i.VISUALIZER="digraph"==O?"dot":O),"ast"==O?C(i):"dexgraph"==O?I(i):"actdiag"==O?x(i):"blockdiag"==O?w(i):"nwdiag"==O?A(i):"seqdiag"==O?B(i):"mscgen"==O?J(i):"plantuml_sequence"==O?P(i):"dendrogram"==O?_(i):R(i),u[y-1];case 5:this.$=n(i,u[y]);break;case 6:if(this.$=n(i,u[y]).trim().toLowerCase(),-1==["actor","beginpoint","box","circle","cloud","condition","database","default","diamond","dots","doublecircle","ellipse","endpoint","input","loopin","loopout","mail","minidiamond","minisquare","note","record","roundedbox","square","terminator","loop","loopend","loopstart","rect","rectangle"].indexOf(this.$))throw new Error("Must use declared shape");break;case 8:this.$=l(i,u[y-3],u[y-5]).setColor(u[y-1]),this.$ instanceof b&&T(this.$.setShape(u[y-4]).setImage(u[y]),"compass",u[y-2]);break;case 9:this.$=p(i);break;case 10:this.$=a(i,u[y-3],u[y],u[y-1]);break;case 12:this.$=d(i);break;case 13:this.$=m(i,u[y-5],u[y-7],u[y-1],u[y-2],u[y]?u[y].substring(1):u[y],u[y-3],u[y-6],u[y-4]).right;break;case 14:this.$=this.$.setLabel(u[y].substring(1));break;case 16:this.$=n(i,u[y]);break;case 17:E("SHAPE getShapeOrVariablleee "),"default"==u[y]&&(u[y]=void 0),this.$=s(i).setCurrentShape(u[y]);break;case 18:c(i).setEqual(u[y]instanceof b?new Array(u[y]):u[y]);break;case 19:throw new Error("Expecting one of the shapes, got ("+u[y]+")");case 20:this.$=s(i).setDirection("landscape");break;case 21:this.$=s(i).setGenerator(u[y]);break;case 22:this.$=s(i).setVisualizer(u[y]);break;case 23:this.$=s(i).setDirection("portrait");break;case 24:this.$="/*"+u[y].substring(2)+"*/\n";break;case 25:this.$=c(i).setDefault("nodecolor","default"==u[y]?void 0:u[y]);break;case 26:this.$=c(i).setDefault("nodetextcolor","default"==u[y]?void 0:u[y]);break;case 27:this.$=c(i).setDefault("linkcolor","default"==u[y]?void 0:u[y]);break;case 28:this.$=c(i).setDefault("linktextcolor","default"==u[y]?void 0:u[y]);break;case 29:this.$=c(i).setDefault("groupcolor","default"==u[y]?void 0:u[y]);break;case 30:this.$=T(T(h(i,g(i).setLabel(u[y].replace(/\s+then\s*$/,"").replace(/^\s*if\s*/,""))),"conditional","if"),"entrylink",i.lastSeenNode);break;case 31:f(i),this.$=T(h(i,g(i).setLabel(u[y].replace(/\s+then\s*$/,"").replace(/^\s*elseif\s*/,""))),"conditional","elseif");break;case 32:f(i),this.$=T(h(i,g(i).setLabel(u[y])),"conditional","else");break;case 33:f(i),i.collectNextNode=T(h(i,g(i).setLabel(u[y])),"conditional","endif"),E("XXXXXXXXXXXXXXXXXXXXX collectNextNode"+i.collectNextNode),this.$=f(i);break;case 34:this.$=h(i,g(i).setName(u[y-3]).setColor(u[y-2]).setLabel(void 0==u[y-1]?void 0:u[y-1].substring(1)));break;case 35:this.$=f(i);break;case 36:this.$=s(i).setStart(u[y]);break;case 37:}},table:[G(D,K,{3:1,4:2,23:23,18:24,11:26,12:28,8:$,19:q,22:z,31:V,32:H,33:X,34:j,35:M,36:F,37:Z,38:Y,39:Q,40:W,41:te,42:ee,43:re,44:ie,45:ne,46:oe,47:se,52:ae,53:le,54:ue}),G(D,K,{23:23,18:24,11:26,12:28,4:30,1:[3],5:[1,31],8:$,19:q,22:z,31:V,32:H,33:X,34:j,35:M,36:F,37:Z,38:Y,39:Q,40:W,41:te,42:ee,43:re,44:ie,45:ne,46:oe,47:se,52:ae,53:le,54:ue}),G(ce,[2,1]),G(ce,[2,16]),{8:[1,34],9:32,10:[1,35],14:[1,33]},G(D,K,{11:26,12:28,18:36,19:q,22:z,54:ue}),G(ce,[2,20]),{14:[1,37]},{14:[1,38]},G(ce,[2,23]),G(ce,[2,24]),{6:39,7:he,8:fe},{6:42,7:he,8:fe},{6:43,7:he,8:fe},{6:44,7:he,8:fe},{6:45,7:he,8:fe},G(ce,[2,30]),G(ce,[2,31]),G(ce,[2,32]),G(ce,[2,33]),G(pe,[2,60],{48:46,58:[1,47]}),G(ce,[2,35]),{14:[1,48]},G(ce,[2,37],{24:49,25:[2,50],30:[1,50],55:[1,51]}),G(de,[2,15],{20:ge}),G(ye,[2,9]),G(ye,[2,11]),G(ye,[2,12]),{10:[1,54],13:53,14:[2,40]},G(D,[2,39]),G(ce,[2,2]),G(ce,[2,3]),G(ce,[2,17]),G(ce,[2,19]),G(ce,[2,6]),G(ce,[2,7]),G(ce,[2,18],{20:ge}),G(ce,[2,21]),G(ce,[2,22]),G(ce,[2,25]),G(me,[2,4]),G(me,[2,5]),G(ce,[2,26]),G(ce,[2,27]),G(ce,[2,28]),G(ce,[2,29]),G(Oe,[2,62],{49:55,6:56,7:he,8:fe}),G(pe,[2,61]),G(ce,[2,36]),{25:[1,57]},G(de,[2,14]),{25:[2,51]},G(Se,[2,48],{21:58,57:[1,59]}),{14:[1,60]},{14:[2,41]},{30:[1,62],50:61,51:[2,64]},G(Oe,[2,63]),G(be,[2,52],{26:63,55:[1,64]}),G(D,K,{12:28,11:65,54:ue}),G(Se,[2,49]),G([1,5,7,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,56],[2,42],{15:66,55:[1,67]}),{51:[1,68]},{51:[2,65]},G(ve,[2,54],{27:69,6:70,7:he,8:fe}),G(be,[2,53]),G(ye,[2,10]),G([1,5,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55,56],[2,44],{16:71,6:72,7:he,8:fe}),G([1,5,7,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55,56],[2,43]),G(ce,[2,34]),G(Ne,[2,56],{28:73,57:[1,74]}),G(ve,[2,55]),G(ye,[2,46],{17:75,56:[1,76]}),G([1,5,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55,56],[2,45]),G(D,K,{11:26,12:28,18:77,19:q,22:z,54:ue}),G(Ne,[2,57]),G(ye,[2,8]),G(ye,[2,47]),G([1,5,8,10,14,19,22,25,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55],[2,58],{29:78,20:ge,30:[1,79]}),G(de,[2,13]),G(de,[2,59])],defaultActions:{51:[2,51],54:[2,41],62:[2,65]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){function e(){var t;return t=d.lex()||f,"number"!=typeof t&&(t=r.symbols_[t]||t),t}var r=this,i=[0],n=[null],o=[],s=this.table,a="",l=0,u=0,c=0,h=2,f=1,p=o.slice.call(arguments,1),d=Object.create(this.lexer),g={yy:{}};for(var y in this.yy)Object.prototype.hasOwnProperty.call(this.yy,y)&&(g.yy[y]=this.yy[y]);d.setInput(t,g.yy),g.yy.lexer=d,g.yy.parser=this,"undefined"==typeof d.yylloc&&(d.yylloc={});var m=d.yylloc;o.push(m);var O=d.options&&d.options.ranges;this.parseError="function"==typeof g.yy.parseError?g.yy.parseError:Object.getPrototypeOf(this).parseError;for(var S,b,v,N,E,T,L,k,x,C={};;){if(v=i[i.length-1],this.defaultActions[v]?N=this.defaultActions[v]:((null===S||"undefined"==typeof S)&&(S=e()),N=s[v]&&s[v][S]),"undefined"==typeof N||!N.length||!N[0]){var w="";x=[];for(T in s[v])this.terminals_[T]&&T>h&&x.push("'"+this.terminals_[T]+"'");w=d.showPosition?"Parse error on line "+(l+1)+":\n"+d.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[S]||S)+"'":"Parse error on line "+(l+1)+": Unexpected "+(S==f?"end of input":"'"+(this.terminals_[S]||S)+"'"),this.parseError(w,{text:d.match,token:this.terminals_[S]||S,line:d.yylineno,loc:m,expected:x})}if(N[0]instanceof Array&&N.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+S);switch(N[0]){case 1:i.push(S),n.push(d.yytext),o.push(d.yylloc),i.push(N[1]),S=null,b?(S=b,b=null):(u=d.yyleng,a=d.yytext,l=d.yylineno,m=d.yylloc,c>0&&c--);break;case 2:if(L=this.productions_[N[1]][1],C.$=n[n.length-L],C._$={first_line:o[o.length-(L||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(L||1)].first_column,last_column:o[o.length-1].last_column},O&&(C._$.range=[o[o.length-(L||1)].range[0],o[o.length-1].range[1]]),E=this.performAction.apply(C,[a,u,l,g.yy,N[1],n,o].concat(p)),"undefined"!=typeof E)return E;L&&(i=i.slice(0,-1*L*2),n=n.slice(0,-1*L),o=o.slice(0,-1*L)),i.push(this.productions_[N[1]][0]),n.push(C.$),o.push(C._$),k=s[i[i.length-2]][i[i.length-1]],i.push(k);break;case 3:return!0}}return!0}};e.prototype=new t,e.prototype.constructor=e,r.prototype=new t,r.prototype.constructor=r,i.prototype=new t,i.prototype.constructor=i,b.prototype=new t,b.prototype.constructor=b;var Te={blockdiag:{"default":"box",invis:"invis",record:"box",doublecircle:"endpoint",box:"box",rect:"box",rectangle:"box",square:"square",roundedbox:"roundedbox",dots:"dots",circle:"circle",ellipse:"ellipse",diamond:"diamond",minidiamond:"minidiamond",note:"note",mail:"mail",cloud:"cloud",actor:"actor",beginpoint:"flowchart.beginpoint",endpoint:"flowchart.endpoint",condition:"flowchart.condition",database:"flowchart.database",terminator:"flowchart.terminator",input:"flowchart.input",loopin:"flowchart.loopin",loop:"flowchart.loopin",loopstart:"flowchart.loopin",loopout:"flowchart.loopout",loopend:"flowchart.loopout"},actdiag:{"default":"box",invis:"invis",record:"box",doublecircle:"endpoint",box:"box",rect:"box",rectangle:"box",square:"square",roundedbox:"roundedbox",dots:"dots",circle:"circle",ellipse:"ellipse",diamond:"diamond",minidiamond:"minidiamond",note:"note",mail:"mail",cloud:"cloud",actor:"actor",beginpoint:"flowchart.beginpoint",endpoint:"flowchart.endpoint",condition:"flowchart.condition",database:"flowchart.database",terminator:"flowchart.terminator",input:"flowchart.input",loopin:"flowchart.loopin",loop:"flowchart.loopin",loopstart:"flowchart.loopin",loopout:"flowchart.loopout",loopend:"flowchart.loopout"},digraph:{"default":"box",invis:"invis",record:"record",doublecircle:"doublecircle",box:"box",rect:"box",rectangle:"box",square:"square",roundedbox:"box",dots:"point",circle:"circle",ellipse:"ellipse",diamond:"diamond",minidiamond:"Mdiamond",minisquare:"Msquare",note:"note",mail:"tab",cloud:"tripleoctagon",actor:"cds",beginpoint:"circle",endpoint:"doublecircle",condition:"Mdiamond",database:"Mcircle",terminator:"ellipse",input:"parallelogram",loopin:"house",loop:"house",loopstart:"house",loopout:"invhouse",loopend:"invhouse"}};N.prototype=new r,N.prototype.constructor=N,debugIndent=0,String.prototype.format=function(){var t=this;for(var e in arguments)t=t.replace("{"+e+"}",arguments[e]);return t};var Le=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===i.length?this.yylloc.first_column:0)+i[i.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var r,i,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),i=t[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],r=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in n)this[o]=n[o];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,r,i;this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),o=0;o<n.length;o++)if(r=this._input.match(this.rules[n[o]]),r&&(!e||r[0].length>e[0].length)){if(e=r,i=o,this.options.backtrack_lexer){if(t=this.test_match(r,n[o]),t!==!1)return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?(t=this.test_match(e,n[i]),t!==!1?t:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){var t=this.conditionStack.length-1;return t>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0,"case-insensitive":!0},performAction:function(t,e,r,i){function n(t){var e=t.input();if(":"==e){var r=t.input(),i=t.input();if(r.match(/[ns]/i)&&i.match(/[ew]/i)||r.match(/[ensw]/i)&&(i.match(/\s/)||!i.match(/A-Za-z0-9_/)))return t.unput(i),t.unput(r),t.unput(e),"NAME";for(;;){var n=t.input();if(!n.match(/[A-Za-z_0-9]/i)){n.match(/\n/)||t.unput(n);break}}return"NAME"}return t.unput(e),"NAME"}collectNextNode=void 0;switch(r){case 0:return 57;case 1:return 8;case 2:return 43;case 3:return"IF_CLAUSE";case 4:return 44;case 5:return 45;case 6:return 46;case 7:return 30;case 8:return 30;case 9:return 10;case 10:return 54;case 11:return 19;case 12:return 22;case 13:return this.begin("INITIAL"),51;case 14:break;case 15:break;case 16:break;case 17:return 37;case 18:return 20;case 19:return 40;case 20:return 41;case 21:return 38;case 22:return 39;case 23:return 42;case 24:return 7;case 25:return 33;case 26:return 36;case 27:return 32;case 28:return 31;case 29:return 52;case 30:return this.begin("GROUP"),47;case 31:return 53;case 32:return 34;case 33:return 35;case 34:return 25;case 35:return 56;case 36:return 55;case 37:return n(this);case 38:return 58;case 39:return"NUMBER";case 40:return 5;case 41:console.log(e.yytext)}},rules:[/^(?:"[^"]+")/i,/^(?:\$\([^)]+\))/i,/^(?:(if\s+.*then(?=\n)))/i,/^(?:{IF_CLAUSE})/i,/^(?:(else\s*if\s+.*then(?=\n)))/i,/^(?:(else(?=\n)))/i,/^(?:(end\s*if(?=\n)))/i,/^(?:(;[^\n]+))/i,/^(?:(;[^\n]+(\n)))/i,/^(?:(actor|beginpoint|box|circle|cloud|condition|database|default|diamond|dots|doublecircle|ellipse|endpoint|input|loopin|loopout|mail|minidiamond|minisquare|note|record|roundedbox|square|terminator|loop|loopend|loopstart|rect|rectangle\b))/i,/^(?:(dotted|dashed|solid|bold|rounded|diagonals|invis|singularity\b))/i,/^(?:(\())/i,/^(?:(\)))/i,/^(?:[\n])/i,/^(?:[ \t]+)/i,/^(?:\s+)/i,/^(?:\(|\))/i,/^(?:(^\/\/[^\n]*))/i,/^(?:(,))/i,/^(?:link color)/i,/^(?:link textcolor|link text color)/i,/^(?:node color)/i,/^(?:node textcolor|node text color)/i,/^(?:group color)/i,/^(?:(#[A-Fa-f0-9]{6}))/i,/^(?:^(landscape|horizontal|lr))/i,/^(?:^(portrait|vertical|td))/i,/^(?:equal)/i,/^(?:shape)/i,/^(?:group end|\})/i,/^(?:group|\{)/i,/^(?:start)/i,/^(?:generator)/i,/^(?:visualizer)/i,/^(?:<\/|\/>|<\.>|<->|<>|<-|<\.|<|->|\.>|>|-|\.)/i,/^(?:(\/[A-Za-z0-9]+\.png\b))/i,/^(?:(:(nw|ne|n|sw|se|s|e|w)))/i,/^(?:([A-Za-z][A-Za-z_0-9]*))/i,/^(?:([A-Za-z][A-Za-z_0-9]*))/i,/^(?:([0-9])+)/i,/^(?:$)/i,/^(?:.)/i],conditions:{GROUP:{rules:[1,7,13,14,24,38],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,8,9,10,11,12,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,39,40,41],inclusive:!0}}};return t}();return Ee.lexer=Le,U.prototype=Ee,Ee.Parser=U,new U}();"undefined"!=typeof require&&"undefined"!=typeof exports&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),process.exit(1));var e=require("fs").readFileSync(require("path").normalize(t[1]),"utf8");return exports.parser.parse(e)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1)));