<html>
<script type="text/javascript" src="parser.js"></script>
<script type="text/javascript">
parser.yy.OUTPUT="digraph";
VERBOSE=false;
parser.yy.parseError=function(str,hash){
	console.log("Parsing error:");
	console.log(str);
	console.log(hash);
	throw new Error(str);
};
//called line by line...
parser.yy.result=function(line){
   if (parsingStarted){
	parsingStarted=false;
	result.value="";
   }
   result.value=result.value+line+"\n";
}
parser.trace=function(x){console.log("TRACE:"+x);}
</script>
<body>
<form name="contact" action="">  
    <select id="generator" name="generator" onChange="generatorChanged()">
      <option value="digraph">Graphviz - digraph</option>
      <option value="actdiag">Activity Diagram</option>
      <option value="blockdiag">Block diagram</option>
      <option value="nwdiag">Network diagram</option>
    </select>
    <br/>
    <textarea name="source" id="source" rows="30" cols="60"></textarea>
    <textarea name="result" id="result" rows="30" cols="60"></textarea>
</form>
</body>
<script type="text/javascript">
result= document.getElementById("result");
function parse(textArea){
	parsingStarted=true;
	delete (parser.yy.GRAPHROOT);
	delete (parser.yy.LINKS);
	delete (parser.yy.OBJECTS);
	var e = document.getElementById("generator");
	parser.yy.OUTPUT=e.options[e.selectedIndex].value;
	parser.parse(textArea.value+"\n");
}
function generatorChanged()
{
	parse(document.getElementById("source"));
}

function addTextAreaCallback(textArea, callback, delay) {
    var timer = null;
    var tt=textArea;
    textArea.onkeypress = function() {
        if (timer) {
            window.clearTimeout(timer);
        }
        timer = window.setTimeout( function() {
            timer = null;
            callback(tt);
        }, delay );
    };
    textArea = null;
}
addTextAreaCallback( document.getElementById("source"), parse, 250 );
</script>
</html>

