var diagrammer_parser=function(){function e(e,t,i,r){for(i=i||{},r=e.length;r--;i[e[r]]=t);return i}var n,i=[10,14],r=[2,38],o=[1,3],a=[1,25],l=[1,27],c=[1,4],d=[1,5],p=[1,6],b=[1,7],S=[1,8],O=[1,9],x=[1,10],v=[1,11],N=[1,12],T=[1,13],R=[1,14],C=[1,15],w=[1,16],_=[1,17],A=[1,18],L=[1,19],I=[1,20],k=[1,21],D=[1,22],P=[1,29],t=[1,5,8,10,14,19,22,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54],G=[1,40],B=[1,41],J=[7,8,30,51],V=[1,5,8,10,14,19,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55],U=[1,52],q=[1,5,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55],$=[1,5,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,51,52,53,54,55,56,57],z=[30,51],H=[10,14,54],M=[7,8,10,14,19,22,54,57],X=[10,14,19,22,54,57],j=[10,14,19,22,54],o={trace:function(){},yy:{},symbols_:{error:2,S:3,graphContent:4,EOF:5,colorOrVariable:6,COLOR:7,VARIABLE:8,shapeOrVariable:9,SHAPES:10,readVertexAttrs:11,readVertexAttrs_option0:12,readVertexAttrs_option1:13,NAME:14,readVertexAttrs_option2:15,readVertexAttrs_option3:16,readVertexAttrs_option4:17,vertexGroupListOrAttrs:18,OPAREN:19,LISTSEP:20,vertexGroupListOrAttrs_option0:21,CPAREN:22,readEvents:23,readEvents_option0:24,EVENT:25,readEvents_option1:26,readEvents_option2:27,readEvents_option3:28,readEvents_option4:29,LABEL:30,SHAPE:31,EQUAL:32,LANDSCAPE:33,GENERATOR:34,VISUALIZER:35,PORTRAIT:36,COMMENT:37,VERTEX_COLOR:38,VERTEXTEXT_COLOR:39,EDGE_COLOR:40,EDGETEXT_COLOR:41,GROUP_COLOR:42,IF:43,ELSEIF:44,ELSE:45,ENDIF:46,GROUP:47,graphContent_option0:48,graphContent_option1:49,graphContent_option2:50,GROUP_DECLARATION_END:51,GROUP_END:52,START:53,STYLES:54,COMPASS:55,IMAGE:56,INLINE_STRING:57,GROUPNAME:58,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"COLOR",8:"VARIABLE",10:"SHAPES",14:"NAME",19:"OPAREN",20:"LISTSEP",22:"CPAREN",25:"EVENT",30:"LABEL",31:"SHAPE",32:"EQUAL",33:"LANDSCAPE",34:"GENERATOR",35:"VISUALIZER",36:"PORTRAIT",37:"COMMENT",38:"VERTEX_COLOR",39:"VERTEXTEXT_COLOR",40:"EDGE_COLOR",41:"EDGETEXT_COLOR",42:"GROUP_COLOR",43:"IF",44:"ELSEIF",45:"ELSE",46:"ENDIF",47:"GROUP",51:"GROUP_DECLARATION_END",52:"GROUP_END",53:"START",54:"STYLES",55:"COMPASS",56:"IMAGE",57:"INLINE_STRING",58:"GROUPNAME"},productions_:[0,[3,1],[3,2],[3,2],[6,1],[6,1],[9,1],[9,1],[11,6],[18,1],[18,4],[18,1],[18,1],[23,8],[23,2],[23,1],[4,1],[4,2],[4,2],[4,2],[4,1],[4,2],[4,2],[4,1],[4,1],[4,2],[4,2],[4,2],[4,2],[4,2],[4,1],[4,1],[4,1],[4,1],[4,5],[4,1],[4,2],[4,1],[12,0],[12,1],[13,0],[13,1],[15,0],[15,1],[16,0],[16,1],[17,0],[17,1],[21,0],[21,1],[24,0],[24,1],[26,0],[26,1],[27,0],[27,1],[28,0],[28,1],[29,0],[29,1],[48,0],[48,1],[49,0],[49,1],[50,0],[50,1]],performAction:function(e,t,i,r,n,o,c){var s=o.length-1;switch(n){case 1:case 4:case 7:case 11:this.$=o[s];break;case 2:this.$=o[s-1]+o[s];break;case 3:const a=h(r);r.USE_GENERATOR&&a.setGenerator(r.USE_GENERATOR),r.USE_VISUALIZER?a.setVisualizer(r.USE_VISUALIZER):a.getVisualizer()||("digraph"==a.getVisualizer()?a.setVisualizer("dot"):a.setVisualizer(a.getGenerator())),a.EDGES=r.EDGES,a.parseError=r.parseError,a.result=r.result,a.yy=r;const l=generators.get(a.getGenerator());if(!l)throw new Error("Unknown generator "+l);return l(a),o[s-1];case 5:this.$=K(r,o[s]);break;case 6:if(this.$=K(r,o[s]).trim().toLowerCase(),-1==["actor","beginpoint","box","circle","cloud","condition","database","default","diamond","dots","doublecircle","ellipse","endpoint","input","loopin","loopout","mail","minidiamond","minisquare","note","record","roundedbox","square","terminator","loop","loopend","loopstart","rect","rectangle"].indexOf(this.$))throw new Error("Must use declared shape");break;case 8:this.$=ee(r,o[s-3],o[s-5]).setColor(o[s-1]),this.$ instanceof E&&Z(this.$.setShape(o[s-4]).setImage(o[s]),"compass",o[s-2]);break;case 9:this.$=ie(r,function(e,t){if(t instanceof pe)return t;e.SUBGRAPHS||(e.SUBGRAPHS=1);t=new pe(e.SUBGRAPHS++);return ce(e,t),t}(r));break;case 10:this.$=function(e,t,i,r){if(t instanceof E){g("getList(vertex:"+t+",rhs:["+i+"])",!0);const n=[];return n.push(t),n.push(ee(e,i).setEdgeLabel(r)),g("return vertex:"+n,!1),n}if(t instanceof y){g("getList(group:["+t+"],rhs:"+i+")",!0);const o=[];return o.push(t),o.push(ne(e,i).setEdgeLabel(r)),g("return group:"+o,!1),o}return g("getList(lhs:["+t+"],rhs:"+i,!0),t.push(ee(e,i).setEdgeLabel(r)),g("return ["+t+"]",!1),t}(r,o[s-3],o[s],o[s-1]);break;case 12:this.$=function(e){const t=te(e);g("Exit subgraph "+t);let i=null;for(var r in e.EDGES)if(e.EDGES.hasOwnProperty(r)){if((i=e.EDGES[r]).right.name==t.name&&i.left.name==t.entrance.name){e.EDGES.splice(r,1);break}i=null}if(null!==i)for(var n in t.ROOTVERTICES)if(t.ROOTVERTICES.hasOwnProperty(n)){const s=t.ROOTVERTICES[n],a=(t.entrance.noedges=void 0,s.noedges=void 0,oe(e,i.edgeType,t.entrance,s,i.label,void 0,void 0,void 0,void 0,!0));a.container=t,e.EDGES.splice(r++,0,a)}const o=[];for(var s in t.OBJECTS)t.OBJECTS.hasOwnProperty(s)&&(s=t.OBJECTS[s],se(e,s)||o.push(s));return g("exits "+o),t.setExit(s),re(e)}(r);break;case 13:this.$=oe(r,o[s-5],o[s-7],o[s-1],o[s-2],o[s]&&o[s].substring(1),o[s-3],o[s-6],o[s-4]).right;break;case 14:this.$=this.$.setLabel(o[s].substring(1));break;case 16:this.$=K(r,o[s]);break;case 17:g("SHAPE getShapeOrVariablleee "),"default"==o[s]&&(o[s]=void 0),this.$=h(r).setCurrentShape(o[s]);break;case 18:te(r).setEqual(o[s]instanceof E?new Array(o[s]):o[s]);break;case 19:throw new Error("Expecting one of the shapes, got ("+o[s]+")");case 20:this.$=h(r).setDirection("landscape");break;case 21:this.$=h(r).setGenerator(o[s]);break;case 22:this.$=h(r).setVisualizer(o[s]);break;case 23:this.$=h(r).setDirection("portrait");break;case 24:this.$="/*"+o[s].substring(2)+"*/\n";break;case 25:this.$=te(r).setDefault("vertexcolor","default"==o[s]?void 0:o[s]);break;case 26:this.$=te(r).setDefault("vertextextcolor","default"==o[s]?void 0:o[s]);break;case 27:this.$=te(r).setDefault("edgecolor","default"==o[s]?void 0:o[s]);break;case 28:this.$=te(r).setDefault("edgetextcolor","default"==o[s]?void 0:o[s]);break;case 29:this.$=te(r).setDefault("groupcolor","default"==o[s]?void 0:o[s]);break;case 30:this.$=Z(Z(ie(r,ne(r).setLabel(o[s].replace(/\s+then\s*$/,"").replace(/^\s*if\s*/,""))),"conditional","if"),"entryedge",r.lastSeenVertex);break;case 31:re(r),this.$=Z(ie(r,ne(r).setLabel(o[s].replace(/\s+then\s*$/,"").replace(/^\s*elseif\s*/,""))),"conditional","elseif");break;case 32:re(r),this.$=Z(ie(r,ne(r).setLabel(o[s])),"conditional","else");break;case 33:re(r),r.collectNextVertex=Z(ie(r,ne(r).setLabel(o[s])),"conditional","endif"),g("XXXXXXXXXXXXXXXXXXXXX collectNextVertex"+r.collectNextVertex),this.$=re(r);break;case 34:this.$=ie(r,ne(r).setName(o[s-3]).setColor(o[s-2]).setLabel(null==o[s-1]?void 0:o[s-1].substring(1)));break;case 35:this.$=re(r);break;case 36:this.$=h(r).setStart(o[s])}},table:[e(i,r,{3:1,4:2,23:23,18:24,11:26,12:28,8:o,19:a,22:l,31:c,32:d,33:p,34:b,35:S,36:O,37:x,38:v,39:N,40:T,41:R,42:C,43:w,44:_,45:A,46:L,47:I,52:k,53:D,54:P}),e(i,r,{23:23,18:24,11:26,12:28,4:30,1:[3],5:[1,31],8:o,19:a,22:l,31:c,32:d,33:p,34:b,35:S,36:O,37:x,38:v,39:N,40:T,41:R,42:C,43:w,44:_,45:A,46:L,47:I,52:k,53:D,54:P}),e(t,[2,1]),e(t,[2,16]),{8:[1,34],9:32,10:[1,35],14:[1,33]},e(i,r,{11:26,12:28,18:36,19:a,22:l,54:P}),e(t,[2,20]),{14:[1,37]},{14:[1,38]},e(t,[2,23]),e(t,[2,24]),{6:39,7:G,8:B},{6:42,7:G,8:B},{6:43,7:G,8:B},{6:44,7:G,8:B},{6:45,7:G,8:B},e(t,[2,30]),e(t,[2,31]),e(t,[2,32]),e(t,[2,33]),e(J,[2,60],{48:46,58:[1,47]}),e(t,[2,35]),{14:[1,48]},e(t,[2,37],{24:49,25:[2,50],30:[1,50],55:[1,51]}),e(V,[2,15],{20:U}),e(q,[2,9]),e(q,[2,11]),e(q,[2,12]),{10:[1,54],13:53,14:[2,40]},e(i,[2,39]),e(t,[2,2]),e(t,[2,3]),e(t,[2,17]),e(t,[2,19]),e(t,[2,6]),e(t,[2,7]),e(t,[2,18],{20:U}),e(t,[2,21]),e(t,[2,22]),e(t,[2,25]),e($,[2,4]),e($,[2,5]),e(t,[2,26]),e(t,[2,27]),e(t,[2,28]),e(t,[2,29]),e(z,[2,62],{49:55,6:56,7:G,8:B}),e(J,[2,61]),e(t,[2,36]),{25:[1,57]},e(V,[2,14]),{25:[2,51]},e(H,[2,48],{21:58,57:[1,59]}),{14:[1,60]},{14:[2,41]},{30:[1,62],50:61,51:[2,64]},e(z,[2,63]),e(M,[2,52],{26:63,55:[1,64]}),e(i,r,{12:28,11:65,54:P}),e(H,[2,49]),e([1,5,7,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,56],[2,42],{15:66,55:[1,67]}),{51:[1,68]},{51:[2,65]},e(X,[2,54],{27:69,6:70,7:G,8:B}),e(M,[2,53]),e(q,[2,10]),e([1,5,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55,56],[2,44],{16:71,6:72,7:G,8:B}),e([1,5,7,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55,56],[2,43]),e(t,[2,34]),e(j,[2,56],{28:73,57:[1,74]}),e(X,[2,55]),e(q,[2,46],{17:75,56:[1,76]}),e([1,5,8,10,14,19,20,22,25,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55,56],[2,45]),e(i,r,{11:26,12:28,18:77,19:a,22:l,54:P}),e(j,[2,57]),e(q,[2,8]),e(q,[2,47]),e([1,5,8,10,14,19,22,25,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,53,54,55],[2,58],{29:78,20:U,30:[1,79]}),e(V,[2,13]),e(V,[2,59])],defaultActions:{51:[2,51],54:[2,41],62:[2,65]},parseError:function(e,t){if(!t.recoverable){function i(e,t){this.message=e,this.hash=t}throw i.prototype=Error,new i(e,t)}this.trace(e)},parse:function(h){var u,d=this,e=[0],t=[null],i=[],p=this.table,g="",f=0,m=0,E=0,y=1,b=i.slice.call(arguments,1),r=Object.create(this.lexer),n={yy:{}};for(u in this.yy)Object.prototype.hasOwnProperty.call(this.yy,u)&&(n.yy[u]=this.yy[u]);r.setInput(h,n.yy),n.yy.lexer=r,n.yy.parser=this,void 0===r.yylloc&&(r.yylloc={});var S=r.yylloc,O=(i.push(S),r.options&&r.options.ranges);"function"==typeof n.yy.parseError?this.parseError=n.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var o,x,s,a,v,l,N,T=function(){var e=r.lex()||y;return e="number"!=typeof e?d.symbols_[e]||e:e},c={};;){if(s=e[e.length-1],void 0===(a=this.defaultActions[s]||(null==o&&(o=T()),p[s]&&p[s][o]))||!a.length||!a[0]){var R="",C=[];for(v in p[s])this.terminals_[v]&&2<v&&C.push("'"+this.terminals_[v]+"'");R=r.showPosition?"Parse error on line "+(f+1)+":\n"+r.showPosition()+"\nExpecting "+C.join(", ")+", got '"+(this.terminals_[o]||o)+"'":"Parse error on line "+(f+1)+": Unexpected "+(o==y?"end of input":"'"+(this.terminals_[o]||o)+"'"),this.parseError(R,{text:r.match,token:this.terminals_[o]||o,line:r.yylineno,loc:S,expected:C})}if(a[0]instanceof Array&&1<a.length)throw new Error("Parse Error: multiple actions possible at state: "+s+", token: "+o);switch(a[0]){case 1:e.push(o),t.push(r.yytext),i.push(r.yylloc),e.push(a[1]),o=null,x?(o=x,x=null):(m=r.yyleng,g=r.yytext,f=r.yylineno,S=r.yylloc,0<E&&E--);break;case 2:if(l=this.productions_[a[1]][1],c.$=t[t.length-l],c._$={first_line:i[i.length-(l||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(l||1)].first_column,last_column:i[i.length-1].last_column},O&&(c._$.range=[i[i.length-(l||1)].range[0],i[i.length-1].range[1]]),void 0!==(N=this.performAction.apply(c,[g,m,f,n.yy,a[1],t,i].concat(b))))return N;l&&(e=e.slice(0,-1*l*2),t=t.slice(0,-1*l),i=i.slice(0,-1*l)),e.push(this.productions_[a[1]][0]),t.push(c.$),i.push(c._$),N=p[e[e.length-2]][e[e.length-1]],e.push(N);break;case 3:return!0}}return!0}},F=(generators=new Map,visualizations=new Map,0);function g(e,t=void 0){if(1==n&&!1!==e&&!0!==e){for(var i="",r=0;r<F;r++)i+="    ";console.log(i+e)}!0===t||!0===e?F++:!1!==t&&!1!==e||F--}function Z(e,t,i){return e[t]=i,e}function Y(e,t){if(e[t]&&0!=e[t])return e[t]}function f(e,t,i,r){if(t instanceof Array){for(const o in t)if(t.hasOwnProperty(o)){const n=f(e,t[o],i,r);if(""!==n)return g("Return "+n),n}return""}if(!e[t]||0==e[t])return"";const n=i.format(e[t]);return r&&r.push(n)," "+n+" "}String.prototype.format=function(){var e=this;for(const t in arguments)e=e.replace("{"+t+"}",arguments[t]);return e},String.prototype.formatArray=function(t){let i=this;for(let e=0;e<t.length;e++)i=i.replace("{"+e+"}",t[e]);return i};var W=0;function m(e,t,i=void 0){let r="";if(!0!==t&&!1!==t&&!0!==e&&!1!==e){for(let e=0;e<W;e++)r+="    ";e.result(r+t)}!0===i||!0===e||!0===t?W++:!1!==i&&!1!==e&&!1!==t||W--}function Q(e,t,i){i?e.result(t.formatArray(i)):e.result(t)}function K(e,t){const i=t.slice(2,-1);if(-1!==i.indexOf(":"))return g("GOT assignment "+(t=i.split(":"))[0]+"="+t[1]),ae(e)[t[0]]=t[1],t[1];if(!ae(e)[i])throw new Error("Variable "+i+" not defined");return ae(e)[i]}function ee(e,t,i){g("getVertex (name:"+t+",style:"+i+")",!0);i=function(e,t,s){if(t instanceof E)return s&&t.setStyle(s),t;if(t instanceof Array)return t;var i=function e(t,i){if(t.getName()==i)return t;for(const n in t.OBJECTS)if(t.OBJECTS.hasOwnProperty(n)){const o=t.OBJECTS[n];if(o instanceof E&&o.getName()==i)return s&&o.setStyle(s),o;if(o instanceof y){var r=e(o,i);if(r)return r}}}(h(e),t);if(i)return i;g("Create new vertex name="+t,!0);const r=new E(t,h(e).getCurrentShape());return s&&r.setStyle(s),r.noedges=!0,le(e,"vertexcolor",function(e){r.setColor(e)}),le(e,"vertextextcolor",function(e){r.setTextColor(e)}),g(!1),ce(e,r)}(e,t,i);return g("  in getVertex gotVertex "+i),e.lastSeenVertex=i,e.collectNextVertex&&(g("Collect next vertex"),e.collectNextVertex.exitedge=t,e.collectNextVertex=void 0),g(!1),i}function te(e){return h(e),e.CURRENTCONTAINER[e.CURRENTCONTAINER.length-1]}function ie(e,t){return e.CURRENTCONTAINER.push(t),t}function re(e){if(e.CURRENTCONTAINER.length<=1)throw new Error("INTERNAL ERROR:Trying to exit ROOT container");const t=e.CURRENTCONTAINER.pop();return t.exitvertex=e.CONTAINER_EXIT++,t}function ne(e,t){if(t instanceof y)return t;g("getGroup() NEW GROUP:"+e+"/"+t,!0),e.GROUPIDS||(e.GROUPIDS=1);const i=new y(e.GROUPIDS++);return g("push group "+i+" to "+e),ce(e,i),le(e,"groupcolor",function(e){i.setColor(e)}),g(!1),i}function oe(h,u,t,i,r,n,o,s,a,d){let p;const e=te(h);var l;if(g(!0),i instanceof pe&&!i.getEntrance()&&i.setEntrance(t),i.noedges&&e&&(g("REMOVE "+i+" from root vertices of the container "+e),0<=(l=e.ROOTVERTICES.indexOf(i))&&e.ROOTVERTICES.splice(l,1)),t.noedges=void 0,i.noedges=void 0,e instanceof pe&&!e.getEntrance()&&t instanceof E&&!(i instanceof pe)&&e.setEntrance(t),t instanceof Array){g("getEdge LHS array, type:"+u+" l:["+t+"] r:"+i+" inlineEdgeLabel:"+r+" commonEdgeLabel: "+n+" edgeColor:"+o+" lcompass:"+s+" rcompass:"+a);for(let e=0;e<t.length;e++)g("    1Get edge "+t[e]),p=oe(h,u,t[e],i,r,n,o,s,a);return g(!1),p}if(i instanceof Array){g("getEdge RHS array, type:"+u+" l:"+t+" r:["+i+"] inlineEdgeLabel:"+r+" commonEdgeLabel: "+n+" edgeColor:"+o+" lcompass:"+s+" rcompass:"+a);for(let e=0;e<i.length;e++)g("    2Get edge "+i[e]),p=oe(h,u,t,i[e],r,n,o,s,a);return g(!1),p}{let e="";r&&(e+="inlineEdgeLabel: "+r),n&&(e+="commonEdgeLabel: "+n),o&&(e+="edgeColor: "+o),s&&(e+="lcompass: "+s),a&&(e+="rcompass: "+a),g("getEdge type:"+u+" l:"+t+" r:"+i+e)}if(!(t instanceof E)&&!(t instanceof y)&!(t instanceof pe))throw new Error("LHS not a Vertex,Group nor a SubGraph(LHS="+t+") RHS=("+i+")");if(!(i instanceof E||i instanceof y||i instanceof pe))throw new Error("RHS not a Vertex,Group nor a SubGraph(LHS="+t+") RHS=("+i+")");const c=new de(u,t,i);return s?c.lcompass=s:Y(t,"compass")&&(c.lcompass=Y(t,"compass")),a?c.rcompass=a:Y(i,"compass")&&(c.rcompass=Y(i,"compass")),le(h,"edgecolor",function(e){c.setColor(e)}),le(h,"edgetextcolor",function(e){c.setTextColor(e)}),n&&(c.setLabel(n),g("  set commonEdgeLabel "+n)),r?(c.setLabel(r),g("  set inlineEdgeLabel "+r)):i instanceof E&&n&&(c.setLabel(n),g("  set commonEdgeLabel "+n)),i instanceof E&&((l=i.getEdgeLabel())&&(c.setLabel(l),g("  reset edge label to "+l))),o&&c.setColor(o),d||(l=h,(d=c)instanceof Array?g("PUSH EDGE ARRAY:"+d,!0):(g("PUSH EDGE:"+d,!0),d.container=te(l)),l.EDGES.push(d),g(!1)),g(!1),c}function h(e){if(!e.GRAPHVANVAS){if(!e.result)throw new Error("Initialization has failed!");g("...Initialize emptyroot "+e),e.CURRENTCONTAINER=[],e.EDGES=[],e.CONTAINER_EXIT=1,e.GRAPHVANVAS=new ue,ie(e,e.GRAPHVANVAS)}return e.GRAPHVANVAS}function se(e,t){for(const i in e.EDGES)if(e.EDGES.hasOwnProperty(i))if(e.EDGES[i].left.name===t.name)return 1}function u(e,t){for(const i in e.EDGES)e.EDGES.hasOwnProperty(i)&&t(e.EDGES[i])}function s(e,t){for(const i in e.OBJECTS)e.OBJECTS.hasOwnProperty(i)&&t(e.OBJECTS[i])}function ae(e){return e.VARIABLES||(e.VARIABLES={}),e.VARIABLES}function le(e,t,i){h(e);for(const n in e.CURRENTCONTAINER)if(e.CURRENTCONTAINER.hasOwnProperty(n)){const o=e.CURRENTCONTAINER[n],r=o.getDefault(t);if(r)return i&&i(r),r}const r=h(e).getDefault(t);return r&&(g("_getDefaultAttribute got from graphcanvas"),i&&i(r),r)}function ce(e,t){const i=te(e);return g("_pushObject "+t+"to "+i,!0),i.OBJECTS.push(t),i.ROOTVERTICES.push(t),g(!1),t}class he{constructor(e){this.label=e,this.name=void 0,this.color=void 0,this.textcolor=void 0,this.url=void 0}setName(e){return e&&(this.name=e),this}getName(){return this.name}setColor(e){return e&&(this.color=e),this}getColor(){return this.color}setTextColor(e){return this.textcolor=e,this}getTextColor(){return this.textcolor}setUrl(e){return this.url=e,this}getUrl(){return this.url}setLabel(t){if(t){let e=(t=t.trim().replace(/"/gi,"")).match(/^(#[A-Fa-f0-9]{6,6})(.*)$/);null!==e&&3==e.length&&(this.setTextColor(e[1]),t=e[2].trim()),null!==(e=t.match(/\[([^\]]+)\](.*)$/))&&3<=e.length&&(this.setUrl(e[1]),t=e[2].trim())}return this.label=t,this}getLabel(){return this.label}toString(){return"GraphObject"}}class E extends he{constructor(e,t){super(void 0),this.name=e,this.shape=t,this.image=void 0,this.style=void 0,this.edgelabel=void 0}setShape(e){return e&&(this.shape=e.toLowerCase()),this}getShape(){return this.shape}setEdgeLabel(e){return this.edgelabel=e,this}getEdgeLabel(){var e=this.edgelabel;return this.edgelabel=void 0,e}setStyle(e){return e&&(this.style=e.toLowerCase()),this}getStyle(){return this.style}setImage(e){return e&&(this.image=e),this}getImage(){return this.image}toString(){let e="";return this.color&&(e+=",color: "+this.color),this.label&&(e+=",label: "+this.label),"Vertex(name:"+this.getName()+e+")"}}class y extends he{constructor(e){super(void 0),this.name=e,this.OBJECTS=[],this.ROOTVERTICES=[],this.equal=void 0,this.edgelabel=void 0,this.exitvertex=void 0,this.entryedge=void 0}setEqual(e){return this.equal=e,this}getEqual(){return this.equal}setEdgeLabel(e){return this.edgelabel=e,this}getEdgeLabel(){return this.edgelabel}setDefault(e,t){return g("group:Set group "+e+" to "+t),Z(this,e,t)}getDefault(e){return g("group:Get group "+e),Y(this,e)}toString(){return"group:Group("+this.name+")"}}class ue extends he{parseError=void 0;result=void 0;constructor(){super(void 0),this.OBJECTS=[],this.EDGES=[],this.ROOTVERTICES=[],this.generator=void 0,this.visualizer=void 0,this.shape=void 0,this.direction=void 0,this.start=void 0,this.equal=[]}setGenerator(e){return this.generator=e.toLowerCase(),this}getGenerator(){return this.generator}setVisualizer(e){return this.visualizer=e.toLowerCase(),this}getVisualizer(){return this.visualizer}setCurrentShape(e){return e=e&&e.toLowerCase(),this.shape=e,this}getCurrentShape(){return this.shape}setDirection(e){return this.direction=e,this}getDirection(){return this.direction}setStart(e){return this.start=e,this}getStart(){return this.start}setEqual(e){return this.equal=e,this}getEqual(){return this.equal}setDefault(e,t){return Z(this,e,t)}getDefault(e){return Y(this,e)}toString(){return"GraphCanvas"}}class de extends he{constructor(e,t,i){super(void 0),this.edgeType=e.trim(),this.left=t,this.right=i,this.lcompass=void 0,this.rcompass=void 0,this.edgetextcolor=void 0,this.edgecolor=void 0,this.container=void 0}isDotted(){return-1!==this.edgeType.indexOf(".")}isDashed(){return-1!==this.edgeType.indexOf("-")}isBroken(){return-1!==this.edgeType.indexOf("/")}isBidirectional(){return this.isLeftPointingEdge()&&this.isRightPointingEdge()}isUndirected(){return!this.isLeftPointingEdge()&&!this.isRightPointingEdge()}isLeftPointingEdge(){return-1!==this.edgeType.indexOf("<")}isRightPointingEdge(){return-1!==this.edgeType.indexOf(">")}toString(){let e="";return this.lcompass&&(e+=",lcompass: "+this.lcompass),this.rcompass&&(e+=",rcompass: "+this.rcompass),this.edgecolor&&(e+=",color: "+this.edgecolor),this.edgetextcolor&&(e+=",textcolor: "+this.edgetextcolor),"Edge(type:"+this.edgeType+" as L:"+this.left.toString()+", R:"+this.right.toString()+",label="+this.getLabel()+e+")"}}class pe extends y{constructor(e){super(void 0),this.name=e,this.OBJECTS=[],this.ROOTVERTICES=[],this.isInnerGraph=!0,this.entrance=void 0,this.exit=void 0}setEdgeLabel(e){return this.edgelabel=e,this}getEdgeLabel(){return this.edgelabel}setEntrance(e){return g("subgraph:Set entrance to "+e),this.entrance=e,this}getEntrance(){return this.entrance}setExit(e){return g("subgraph:Set exit to "+e),this.exit=e,this}getExit(){return this.exit}toString(){let e="";return this.edgelabel&&(e+=",edgelabel:"+this.edgelabel),this.entrance&&(e+=",entrance:"+this.entrance),this.exit&&(e+=",exit:"+this.exit),this.ROOTVERTICES&&(e+=",rootvertices:"+this.ROOTVERTICES),"SubGraph(name:"+this.name+e+")"}}class ge{constructor(e){this.CHILDREN=[],this.data=e}toString(){return"tree("+data+",children=["+JSON.stringify(this.data)+"])"}}function fe(e,t){if(e.data===t)return e;for(const r in e.CHILDREN)if(e.CHILDREN.hasOwnProperty(r)){var i=e.CHILDREN[r];if(i.data===t)return i;if(0<i.CHILDREN.length){i=fe(i,t);if(i)return i}}}function me(e,t,i,r,n=void 0,o=void 0){for(var s in o=o||!1,0===(n=n||0)&&t(e,0===e.CHILDREN.length,!1),0<e.CHILDREN.length&&i(e),e.CHILDREN){var a,l,c;e.CHILDREN.hasOwnProperty(s)&&(l=0===(a=e.CHILDREN[s]).CHILDREN.length,c=parseInt(s)+1!==e.CHILDREN.length,g("vertex "+a.data.name+" is leaf?"+l+" hasSiblings"+c+" i="+(parseInt(s)+1)+"/"),t(a,l,c),0<a.CHILDREN.length&&me(a,t,i,r,n+1,c))}0<e.CHILDREN.length&&(g(e.data.name+="has sibling"),r(e,o))}const Ee={default:"box",invis:"invis",record:"box",doublecircle:"endpoint",box:"box",rect:"box",rectangle:"box",square:"square",roundedbox:"roundedbox",dots:"dots",circle:"circle",ellipse:"ellipse",diamond:"diamond",minidiamond:"minidiamond",minisquare:"minidiamond",note:"note",mail:"mail",cloud:"cloud",actor:"actor",beginpoint:"flowchart.beginpoint",endpoint:"flowchart.endpoint",condition:"flowchart.condition",database:"flowchart.database",terminator:"flowchart.terminator",input:"flowchart.input",loopin:"flowchart.loopin",loop:"flowchart.loop",loopstart:"flowchart.loopin",loopout:"flowchart.loopout",loopend:"flowchart.loopout"};generators.set("actdiag",function(n){m(n,"actdiag {",!0),m(n,"default_fontsize = 14"),s(n,i=>{if(m(!0),i instanceof y)m(n,'lane "'+i.getName()+'"{',!0),s(i,e=>{if(e.shape&&!Ee[e.shape])throw new Error("Missing shape mapping");var t=Ee[e.shape]||Ee.default;let i=f(e,"color",',color="{0}"')+",shape={0}".format(t)+f(e,"label",',label="{0}"');""!=i.trim()&&(i="["+i.trim().substring(1)+"]"),m(n,e.getName()+i+";")}),m(!1),m(n,"}");else{let e=f(i,"style",',style="{0}"');if(""!=e&&null==e.match(/(dotted|dashed|solid)/)&&(e=""),i.shape&&!Ee[i.shape])throw new Error("Missing shape mapping");var r=Ee[i.shape]||Ee.default;let t=f(i,"color",',color="{0}"')+f(i,"image",',background="icons{0}"')+e+",shape={0}".format(r)+f(i,"label",',label="{0}"');""!=t.trim()&&(t="["+t.trim().substring(1)+"]"),m(n,i.getName()+t+";")}m(!1)}),u(n,e=>{let t="";e.isDotted()?t+=',style="dotted" ':e.isDashed()&&(t+=',style="dashed" ');var i=f(e,"label",',label = "{0}"'),r=f(e,"color",',color="{0}"');""!=(t=","==(t=(t+=i+r).trim()).substring(0,1)?t.substring(1).trim():t)&&(t="["+t+"]"),m(n,"  "+e.left.getName()+" -> "+e.right.getName()+t+";")}),m(n,"}")}),generators.set("ast",function(i){g(i),m(i,"[");const r=(e,t)=>t,n=(i.getVisualizer()&&m(i,JSON.stringify({visualizer:i.getVisualizer()})),i.getDirection()&&m(i,JSON.stringify({direction:i.getDirection()})),i.getStart()&&m(i,JSON.stringify({start:i.getStart()})),i.getEqual()&&m(i,JSON.stringify({equal:i.getEqual()})),e=>{if(m(!0),e instanceof y)(e=>{const t=JSON.parse(JSON.stringify(e,r));t.OBJECTS=void 0,m(i,JSON.stringify({group:t})+","),m(i,"["),s(e,n),m(i,"]")})(e);else if(e instanceof pe)(e=>{const t=JSON.parse(JSON.stringify(e,r));t.OBJECTS=void 0,m(i,JSON.stringify({subgraph:t})+","),m(i,"["),s(e,n),m(i,"]")})(e);else{if(!(e instanceof E))throw new Error("Not a node nor a group, NOT SUPPORTED");m(i,JSON.stringify({node:e})+",")}m(!1)});s(i,n),m(!0),u(i,e=>{const t=JSON.parse(JSON.stringify(e,r));t.left=t.left.name,t.right=t.right.name,t.container.OBJECTS=void 0,t.container.label=void 0,t.container.isInnerGraph=void 0,t.container.entrance=t.container.entrance?t.container.entrance.name:void 0,t.container.exitvertex=t.container.exitvertex?t.container.exitvertex.name:void 0,t.container.conditional=void 0,t.container=t.container.name,m(i,JSON.stringify({edge:t})+",")}),m(!1),m(i,"]",!1)});const ye={default:"box",invis:"invis",record:"box",doublecircle:"endpoint",box:"box",rect:"box",rectangle:"box",square:"square",roundedbox:"roundedbox",dots:"dots",circle:"circle",ellipse:"ellipse",diamond:"diamond",minidiamond:"minidiamond",minisquare:"minidiamond",note:"note",mail:"mail",cloud:"cloud",actor:"actor",beginpoint:"flowchart.beginpoint",endpoint:"flowchart.endpoint",condition:"flowchart.condition",database:"flowchart.database",terminator:"flowchart.terminator",input:"flowchart.input",loopin:"flowchart.loopin",loop:"flowchart.loop",loopstart:"flowchart.loopin",loopout:"flowchart.loopout",loopend:"flowchart.loopout"};generators.set("blockdiag",function(n){m(n,"blockdiag {",!0),m(n,"default_fontsize = 14"),"portrait"===n.getDirection()?m(n,"orientation=portrait"):m(n,"orientation=landscape");var e=n.getStart();s(n,i=>{if(m(!0),i instanceof y)m(n,' group "'+i.getLabel()+'"{',!0),m(n,f(i,"color",'   color="{0}"')),m(n,f(i,"label",'   label="{0}"')),e&&""!=e.trim()&&(e="["+e.trim().substring(1)+"]"),s(i,e=>{if(e.shape&&!ye[e.shape])throw new Error("Missing shape mapping");var t=ye[e.shape]||Ee.default;let i=f(e,"color",',color="{0}"')+",shape={0}".format(t)+f(e,"label",',label="{0}"');""!=i.trim()&&(i="["+i.trim().substring(1)+"]"),m(n,e.getName()+i+";")}),m(!1),m(n,"}");else{let e=f(i,"style",',style="{0}"');if(""!=e&&null==e.match(/(dotted|dashed|solid)/)&&(e=""),i.shape&&!ye[i.shape])throw new Error("Missing shape mapping");var r=ye[i.shape]||Ee.default;let t=f(i,"color",',color="{0}"')+f(i,"image",',background="icons{0}"')+e+',shape="{0}"'.format(r)+f(i,"label",',label="{0}"');""!=t.trim()&&(t="["+t.trim().substring(1)+"]"),m(n,i.getName()+t+";")}m(!1)}),u(n,e=>{let t="";e.isDotted()?t+=',style="dotted" ':e.isDashed()&&(t+=',style="dashed" ');var i=f(e,"label",',label = "{0}"'),r=f(e,"color",',color="{0}"');""!=(t=","==(t=(t+=i+r).trim()).substring(0,1)?t.substring(1).trim():t)&&(t="["+t+"]"),m(n,"  "+e.left.getName()+" -> "+e.right.getName()+t+";")}),m(n,"}")}),generators.set("dendrogram",function(r){let n;u(r,e=>{var t=e.left,e=e.right;if(n=n||new ge(t),t instanceof E){const i=fe(n,t);if(!i)throw new Error("Left node ("+t.name+") not found from tree");!fe(n,e)&&e instanceof E&&(g("Add "+e.name+" as child of "+i.data.name+" co "+e.container),i.CHILDREN.push(new ge(e)))}}),me(n,(e,t,i)=>{t?(comma=i?",":"",m(r,'{"name": "'+e.data.name+'", "size": 1}'+comma)):(m(r,"{",!0),m(r,'"name": "'+e.data.name+'",'))},e=>{m(r,'"children": [',!0)},(e,t)=>{m(!1),m(r,"]",!1),m(r,t?"},":"}")}),m(!1)}),visualizations.set("dendrogram",["radialdendrogram","circlepacked","reingoldtilford"]);const be={default:"box",invis:"invis",record:"record",doublecircle:"doublecircle",box:"box",rect:"box",rectangle:"box",square:"square",roundedbox:"box",dots:"point",circle:"circle",ellipse:"ellipse",diamond:"diamond",minidiamond:"Mdiamond",minisquare:"Msquare",note:"note",mail:"tab",cloud:"tripleoctagon",actor:"cds",beginpoint:"circle",endpoint:"doublecircle",condition:"MDiamond",database:"Mcircle",terminator:"ellipse",input:"parallelogram",loopin:"house",loop:"house",loopstart:"house",loopout:"invhouse",loopend:"invhouse"};generators.set("digraph",function(d){const o=(e,t)=>"entrance"===e||"exit"===e?null:t,r=e=>{const t=[],i=[],r=(f(e,"color",'fillcolor="{0}"',t),f(e,"color","filled",i),f(e,"style","{0}",i),e.url);if(r&&t.push('URL="'+r.trim()+'"'),0<i.length&&(-1!==i.join("").indexOf("singularity")?(t.push('shape="circle"'),t.push('label=""'),t.push("width=0.01"),t.push("weight=0.01")):t.push('style="'+i.join(",")+'"')),f(e,"image",'image="icons{0}"',t),f(e,"textcolor",'fontcolor="{0}"',t),e.shape){if(e.shape&&!be[e.shape])throw new Error("Missing shape mapping");var n=be[e.shape]||be.default,n='shape="{0}"'.format(n);t.push(n)}f(e,"label",'label="{0}"',t);let o="";0<t.length&&(o="["+t.join(",")+"]"),m(d,e.getName()+o+";")};d.getVisualizer()&&m(d,"/* render:"+d.getVisualizer()+"*/"),m(d,"digraph {",!0),m(d,"compound=true;"),"portrait"===d.getDirection()?m(d,"rankdir=LR;"):m(d,"rankdir=TD;");var e,t=d.getStart();if(t&&(e=ee(d.yy,t),r(e),m(d,"//startnode setup\n  {rank = same;null} {rank = same; "+t+'}\n  null [shape=plaintext, label=""];\n  '+t+"[shape=doublecircle];\n  null->"+t+";\n")),d.getEqual()&&0<d.getEqual().length){m(d,"{rank=same;",!0);for(let e=0;e<d.getEqual().length;e++)m(d,d.getEqual()[e].getName()+";");m(d,"}",!1)}const n=(e=>{for(const t in e.OBJECTS)if(e.OBJECTS.hasOwnProperty(t)){const i=e.OBJECTS[t];i instanceof y&&(0==i.OBJECTS.length?i.OBJECTS.push(new E("invis_"+i.getName()).setStyle("invis")):n(i))}})(d.OBJECTS);let s=void 0,a=void 0;const l=e=>{for(const i in e.OBJECTS)if(e.OBJECTS.hasOwnProperty(i)){var t=e.OBJECTS[i];if(t instanceof y){const n=t.conditional;(e=>{if(g(JSON.stringify(e,o)),m(d,"subgraph cluster_"+e.getName()+" {",!0),e.isInnerGraph&&m(d,"graph[style=invis];"),e.getLabel()&&m(d,f(e,"label",'   label="{0}";')),e.getColor()&&(m(d,"style=filled;"),m(d,f(e,"color",'   color="{0}";\n'))),l(e),m(!1),m(d,"}//end of "+e.getName()+" "+n),n)if(m(d,"//COND "+e.getName()+" "+n),"endif"==n){var t=e.exitedge;t&&(m(d,s+"->"+t+"[color=red];"),m(d,a+"->"+t+";"))}else{t="entry"+e.exitvertex;a||(a="endif"+e.exitvertex,m(d,a+'[shape=circle,label="",width=0.01,height=0.01];')),m(d,t+'[shape=diamond,fixedsize=true,width=1,height=1,label="'+e.getLabel()+'"];'),"if"==n&&m(d,e.entryedge.getName()+"->"+t+";");const i=function(e){for(const r in d.EDGES)if(d.EDGES.hasOwnProperty(r)){var t=d.EDGES[r];for(const n in e.OBJECTS)if(e.OBJECTS.hasOwnProperty(n)){var i=e.OBJECTS[n];if(i==t.left)return i}}}(e),r=function(e){let t=void 0;for(const n in d.EDGES)if(d.EDGES.hasOwnProperty(n)){var i,r=d.EDGES[n];for(const o in e.OBJECTS)e.OBJECTS.hasOwnProperty(o)&&((i=e.OBJECTS[o])==r.left&&(t=i),i==r.right&&(t=i))}return t}(e);s&&m(d,s+"->"+t+'[label="NO",color=red];'),m(d,t+"->"+i.getName()+'[label="YES",color=green,lhead=cluster_'+e.getName()+"];"),m(d,r.getName()+"->"+a+'[label=""];'),s=t}})(t)}else{if(!(t instanceof E))throw new Error("Not a node nor a group, NOT SUPPORTED");r(t)}}};l(d),m(d,"//links start"),u(d,r=>{const e=[];let t=r.label;t&&(-1!==t.indexOf("::")?(t=t.split("::"),e.push('label="'+t[0].trim()+'"'),e.push('xlabel="'+t[1].trim()+'"')):e.push('label="'+t.trim()+'"'));const h=r.url;h&&e.push('URL="'+h.trim()+'"'),f(r,"color",'color="{0}"',e),f(r,["textcolor","color"],'fontcolor="{0}"',e);let n,o=r.right,i=r.left;if(g("// link from "+i+" to "+o),o instanceof y&&(o.isInnerGraph||e.push(" lhead=cluster_"+o.getName()),o.OBJECTS[0]&&(o=o.OBJECTS[0])),i instanceof y){if(i.isInnerGraph||e.push(" ltail=cluster_"+i.getName()),i instanceof pe&&i.getExit()){const l=[];for(const c in i.OBJECTS){var s;i.OBJECTS.hasOwnProperty(c)&&(s=i.OBJECTS[c],se(d.yy,s)||l.push(s))}i=l}else i=i.OBJECTS[0];i}var u;r.isDotted()?e.push('style="dotted"'):r.isDashed()&&e.push('style="dashed"'),r.isBroken()&&e.push('arrowhead="tee"'),r.isBidirectional()?(n="->",e.push("dir=both")):r.isLeftPointingEdge()?(u=i,i=o,o=u,n="->"):r.isRightPointingEdge()?n="->":(n="->",e.push("dir=none"));let a="";0<e.length&&(a="["+e.join(",")+"]"),g("print lhs "+i),g("print rhs "+o),i instanceof Array?i.forEach((e,t,i)=>{m(d,e.getName()+f(r,"lcompass","{0}").trim()+n+o.getName()+f(r,"rcompass","{0}").trim()+a+";")}):m(d,i.getName()+f(r,"lcompass","{0}").trim()+n+o.getName()+f(r,"rcompass","{0}").trim()+a+";")}),m(!1),m(d,"}")}),visualizations.set("digraph",["dot","circo","twopi","neato","fdp","sfpd"]),generators.set("layerbands",function(e){const t={key:"_BANDS",category:"Bands",itemArray:[]},i=[t];s(e,e=>{e instanceof y&&t.itemArray.push({text:e.name})}),u(e,e=>{e.left&&i.push({key:e.right.name,parent:e.left.name})}),m(e,JSON.stringify(i))}),generators.set("mscgen",function(p){m(p,"msc {",!0);let i=!1,g=(s(p,t=>{if(t instanceof y)m(p," /*"+t.getName()+f(t,"label"," {0}")+"*/"),s(t,e=>{let t=f(e,"color",',color="{0}"')+f(e,"style",",style={0}")+f(e,"label",',label="{0}"');""!=t.trim()&&(t="["+t.trim().substring(1)+"]"),m(p,(i?",":"")+"    "+e.getName()+t),i=!0});else if(t instanceof E){let e=f(t,"color",',textbgcolor="{0}"')+f(t,"style",",style={0}")+f(t,"label",',label="{0}"');""!=e.trim()&&(e="["+e.trim().substring(1)+"]"),m(p,(i?",":"")+"  "+t.getName()+e),i=!0}}),m(p,";"),1);u(p,e=>{let t="",i=e.right,r=e.left,n=(i instanceof y&&(t+=" lhead=cluster_"+i.getName(),i=i.OBJECTS[0]),i.getName());var o=e.isDotted(),h=e.isDashed(),u=e.isBroken();const s=[];let a=e.label;var l=e.color,c=e.url;let d="";if(c&&s.push('URL="'+c+'"'),l&&s.push('linecolor="'+l+'"'),a&&(-1!==a.indexOf("::")?(a=a.split("::"),d=a[1].trim(),s.push('label="'+a[0].trim()+'"')):s.push('label="'+a.trim()+'"')),s.push('id="'+g+++'"'),e.isBidirectional())r==i?(t="->",n="*"):t="<=>";else if(e.isLeftPointingEdge()){c=r;r=i,i=c,t=o?">>":h?"->":u?"-x":"=>",n=i.getName()}else if(e.isRightPointingEdge())t=o?">>":h?"->":u?"-x":"=>";else{if(o)return l&&s.push('textcolor="'+l+'"'),void m(p,"...["+s.join(",")+"];");if(h)return l&&s.push('textcolor="'+l+'"'),void m(p,"---["+s.join(",")+"];");m(p,"ERROR: SHOULD NOT HAPPEN")}m(p,r.getName()+t+n+"["+s.join(",")+"];"),""!=d&&m(p,i.getName()+" abox "+i.getName()+'[label="'+d+'"];')}),m(!1),m(p,"}")});const Se={default:"box",invis:"invis",record:"box",doublecircle:"endpoint",box:"box",rect:"box",rectangle:"box",square:"square",roundedbox:"roundedbox",dots:"dots",circle:"circle",ellipse:"ellipse",diamond:"diamond",minidiamond:"minidiamond",minisquare:"minidiamond",note:"note",mail:"mail",cloud:"cloud",actor:"actor",beginpoint:"flowchart.beginpoint",endpoint:"flowchart.endpoint",condition:"flowchart.condition",database:"flowchart.database",terminator:"flowchart.terminator",input:"flowchart.input",loopin:"flowchart.loopin",loop:"flowchart.loop",loopstart:"flowchart.loopin",loopout:"flowchart.loopout",loopend:"flowchart.loopout"};generators.set("nwdiag",function(t){t.result("nwdiag{\n default_fontsize = 16\n");for(const e in t.OBJECTS)if(t.OBJECTS.hasOwnProperty(e)){const n=t.OBJECTS[e];if(n instanceof y){t.result("  network "+n.getName()+"{"),""!=n.getLabel()&&t.result('    address="'+n.getLabel()+'"');for(const o in n.OBJECTS)if(n.OBJECTS.hasOwnProperty(o)){const s=n.OBJECTS[o];if(s.shape&&!Se[s.shape])throw new Error("Missing shape mapping");var i=Se[s.shape]||Se.default;let e=f(s,"color",',color="{0}"')+',shape="{0}"'.format(i)+f(s,"label",',address="{0}"');""!=e.trim()&&(e="["+e.trim().substring(1)+"]"),t.result("    "+s.getName()+e+";")}for(const a in t.EDGES)if(t.EDGES.hasOwnProperty(a)){const l=t.EDGES[a];tmp=f(l,"label",'[address="{0}"]'),l.left==n&&t.result("  "+l.right.getName()+tmp+";"),l.right==n&&t.result("  "+l.left.getName()+tmp+";")}t.result("  }")}else{if(n.shape&&!Se[n.shape])throw new Error("Missing shape mapping");var r=Se[n.shape]||Ee.default;let e=f(n,"color",',color="{0}"')+f(n,"image",',background="icons{0}"')+',shape="{0}"'.format(r)+f(n,"label",',label="{0}"');""!=e.trim()&&(e="["+e.trim().substring(1)+"]"),t.result("    "+n.getName()+e+";")}}u(t,e=>{e.left instanceof y||e.right instanceof y||t.result(e.left.getName()+" -- "+e.right.getName()+";")}),t.result("}")}),generators.set("parsetree",function(e){const r=[],i=e.ROOTVERTICES;if(1<i.length)throw new Error("Only one root node supported");{i[0].id=1;var n=i[0].label||i[0].name;r.push({key:i[0].id,text:n,fill:"#f8f8f8",stroke:"#4d90fe"});let t=2;e.OBJECTS.forEach(e=>{e.id||(e.id=t++)})}u(e,e=>{var t,i;g("edge "+e.left.name+" to "+e.right.name),t=e.left,e=e.right,t instanceof E&&e instanceof E&&(i=e.id,t=t.id,e=e.label||e.name,r.push({key:i,text:e,fill:"#f8f8f8",stroke:"#4d90fe",parent:t}))}),m(e,JSON.stringify(r)),m(!1)});const Oe={default:"box",invis:"invis",record:"record",doublecircle:"doublecircle",box:"box",rect:"box",rectangle:"box",square:"square",roundedbox:"box",dots:"point",circle:"circle",ellipse:"ellipse",diamond:"diamond",minidiamond:"Mdiamond",minisquare:"Msquare",note:"note",mail:"tab",cloud:"tripleoctagon",actor:"cds",beginpoint:"circle",endpoint:"doublecircle",condition:"MDiamond",database:"Mcircle",terminator:"ellipse",input:"parallelogram",loopin:"house",loop:"house",loopstart:"house",loopout:"invhouse",loopend:"invhouse"};function xe(){this.yy={}}return generators.set("plantuml_sequence",function(p){function s(e,t){const i=[],r=[];if(f(e,"style","{0}",r),0<r.length&&(-1!==r.join("").indexOf("singularity")?(i.push('shape="circle"'),i.push('label=""'),i.push("width=0.01"),i.push("weight=0.01")):i.push('style="'+r.join(",")+'"')),f(e,"image",'image="icons{0}"',i),f(e,"textcolor",'fontcolor="{0}"',i),e.shape&&!Oe[e.shape])throw new Error("Missing shape mapping");var n;e.shape&&(n='shape="{0}"'.format(Oe[e.shape]),i.push(n));let o="";0<i.length&&(o="["+i.join(",")+"]"),m(p,"participant {0} {1} {2}".format(f(e,"label",'"{0}" as'),e.getName(),o))}p.getVisualizer()&&Q(p,"/* render: {0} */",[p.getVisualizer()]),m(p,"@startuml"),m(p,"autonumber",!0);var e=p.getStart();e&&(e=ee(p.yy,e),s(e));const a=(s,a)=>{for(const d of function*(e){for(const t in e.EDGES)e.EDGES.hasOwnProperty(t)&&(yield e.EDGES[t])}(p))if(!d.printed){if(d.container!==s)break;d.printed=!0;let e="",t=d.label;t&&-1!==t.indexOf("::")&&(t=t.split("::"),e=t[1].trim(),t=t[0].trim());var l=f(d,"color","[{0}]").trim();let i,r=d.right,n=d.left;r instanceof y&&(r=r.OBJECTS[0]),n instanceof y&&(n=n.OBJECTS[0]),d.isBroken();var c=d.isDotted(),h=d.isDashed();let o=!1;if(-1!==d.edgeType.indexOf("<")&&-1!==d.edgeType.indexOf(">"))i=(c?"-":"")+"-"+l+">",o=!0;else if(-1!==d.edgeType.indexOf("<")){var u=n;n=r,r=u,i=(c?"-":"")+"-"+l+">"}else if(-1!==d.edgeType.indexOf(">"))i=(c?"-":"")+"-"+l+">";else{if(c){m(p,f(d,"label","...{0}..."));continue}if(h){m(p,f(d,"label","=={0}=="));continue}i="-"+l+">"}t=t?":"+t:"",m(p,n.getName()+i+r.getName()+""+t),o&&m(p,r.getName()+i+n.getName()+""+t),a?r.active?(m(n.active=!1),m(p,"deactivate "+n.getName())):(m(p,"activate "+r.getName(),!0),r.active=!0):n.active&&(m(n.active=!1),m(p,"deactivate "+n.getName())),""!=e&&(m(p,"note over "+r.getName()),Q(p,e.replace(/\\n/g,"\n")),m(p,"end note"))}},l=(e,t)=>{for(const n in e.OBJECTS){var i;e.OBJECTS.hasOwnProperty(n)&&((i=e.OBJECTS[n])instanceof E&&s(i))}a(e,t);for(const o in e.OBJECTS)if(e.OBJECTS.hasOwnProperty(o)){var r=e.OBJECTS[o];if(r instanceof y)(function(e){g("processAGroup:"+JSON.stringify(e));let t=e.conditional;t?("if"==t?t="alt":"elseif"==t||"else"==t?t="else":"endif"==t&&(t="end"),m(p,t+" "+e.getLabel())):t="";var i=e.isInnerGraph;e.getColor()&&(m(p,"style=filled;"),m(p,f(e,"color",'   color="{0}";\n'))),l(e,i),a(e)})(r);else if(!r instanceof E)throw new Error("Not a node nor a group, NOT SUPPORTED")}};l(p,!1),a(p),m(!1),m(p,"@enduml")}),generators.set("sankey",function(r){let n;u(r,function(e){var t=e.left,e=e.right;if(n=n||new ge(t),t instanceof E){const i=fe(n,t);if(!i)throw new Error("Left node ("+t.name+") not found from tree");!fe(n,e)&&e instanceof E&&(g("Add "+e.name+" as child of "+i.data.name+" co "+e.container),i.CHILDREN.push(new ge(e)))}}),me(n,function(e,t,i){t?(comma=i?",":"",m(r,'{"name": "'+e.data.name+'", "size": 1}'+comma)):(m(r,"{",!0),m(r,'"name": "'+e.data.name+'",'))},function(e){m(r,'"children": [',!0)},function(e,t){m(!1),m(r,"]",!1),m(r,t?"},":"}")}),m(!1)}),generators.set("seqdiag",function(c){m(c,"seqdiag {",!0),m(c,"autonumber = True;"),m(c,"activation = none;");for(const e in c.OBJECTS)if(c.OBJECTS.hasOwnProperty(e)){const t=c.OBJECTS[e];if(t instanceof y){m(c," /*"+t.getName()+f(t,"label"," {0}*/"));for(const i in t.OBJECTS)if(t.OBJECTS.hasOwnProperty(i)){const r=t.OBJECTS[i];let e=f(r,"style",",style={0}")+f(r,"label",',label="{0}"');""!=e.trim()&&(e="["+e.trim().substring(1)+"]"),m(c,r.getName()+e+";")}}else if(t instanceof E){let e=f(t,"style",",style={0}")+f(t,"label",',label="{0}"')+f(t,"color",',color="{0}"');""!=e.trim()&&(e="["+e.trim().substring(1)+"]"),m(c,t.getName()+e+";")}}u(c,e=>{const t=[];let i="",r=e.right,n=e.left;var o=e.color;o&&t.push('color="'+o+'"');let s=e.label,a=(s&&(-1!==s.indexOf("::")?(s=s.split("::"),t.push('note="'+s[1].trim()+'"'),t.push('label="'+s[0].trim()+'"')):t.push('label="'+s.trim()+'"')),r instanceof y&&(i+=" lhead=cluster_"+r.getName(),r=r.OBJECTS[0]),r.getName());var o=e.isDotted(),l=e.isDashed();if(e.isBroken()&&t.push("failed"),-1!==e.edgeType.indexOf("<")&&-1!==e.edgeType.indexOf(">")){if(r==n)return void m(c,f(e,"label","===BROADCAST:{0}==="));i="=>"}else if(-1!==e.edgeType.indexOf("<"))i=o?"<--":l?"<<--":"<-",a=r.getName();else if(-1!==e.edgeType.indexOf(">"))i=o?"--\x3e":l?"--\x3e>":"->";else{if(o)return void m(c,f(e,"label","...{0}..."));if(l)return void m(c,f(e,"label","==={0}==="));m(c,"ERROR: SHOULD NOT HAPPEN")}t&&0!=t.length||t.push('label=""'),m(c,n.getName()+" "+i+" "+a+"["+t.join(",")+"];")}),m(c,!1),m(c,"}")}),generators.set("umlclass",function(e){const i=[],t=[],r=e=>{const t=e.label||"";return t.startsWith(e.name)?t:e.name+""+t};let n=1;const o=new Map;s(e,e=>{var t;e instanceof y&&(t=n++,o.set(e.name,t),i.push({key:t,name:r(e),properties:[...e.OBJECTS].filter(e=>!r(e).includes(")")).map(e=>{const t={};if(t.name=e.name,e.label){e=e.label.match(/^([+#-]|)([^:]+:|)([^=]+)(=.+|)/);switch(e[1]){case"+":t.visibility="public";break;case"-":t.visibility="private";break;case"#":t.visibility="protected"}return e[2]&&(t.name=e[2]),e[3]&&(t.type=e[3]),e[4]&&(t.default=e[4]),t}}),methods:[...e.OBJECTS].filter(e=>r(e).includes("(")).map(e=>{const t={};if(g(e.label),t.name=e.name,e.label){const i=e.label.match(/^([+#-]|)([^:]+:|)([^=]+)(=.+|)/);switch(i[1]){case"+":t.visibility="public";break;case"-":t.visibility="private";break;case"#":t.visibility="protected"}return i[2]&&(i[2].startsWith("(")?t.name=e.name+i[2]:t.name=i[2]),t}})}))}),g(o),u(e,e=>{relationship="generalization",">"!=e.edgeType&&(relationship="aggregation"),t.push({from:o.get(e.left.name),to:o.get(e.right.name),relationship:relationship})}),m(e,JSON.stringify([i,t]))}),o.lexer={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g),e=(this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t,this.match.split(/(?:\r\n?|\n)/g)),r=(this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1),this.yylloc.range);return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===e.length?this.yylloc.first_column:0)+e[e.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(20<e.length?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(20<e.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(i=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],i=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),i)return i;if(this._backtrack){for(var n in r)this[n]=r[n];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var e,t,i,r,n=this._currentRules(),o=0;o<n.length;o++)if((i=this._input.match(this.rules[n[o]]))&&(!t||i[0].length>t[0].length))if(t=i,r=o,this.options.backtrack_lexer){if(!1!==(e=this.test_match(i,n[o])))return e;if(!this._backtrack)return!1;t=!1}else if(!this.options.flex)break;return t?!1!==(e=this.test_match(t,n[r]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL).rules},topState:function(e){return 0<=(e=this.conditionStack.length-1-Math.abs(e||0))?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0,"case-insensitive":!0},performAction:function(e,t,i,r){collectNextVertex=void 0;switch(i){case 0:return 57;case 1:return 8;case 2:return 43;case 3:return"IF_CLAUSE";case 4:return 44;case 5:return 45;case 6:return 46;case 7:case 8:return 30;case 9:return 10;case 10:return 54;case 11:return 19;case 12:return 22;case 13:return this.begin("INITIAL"),51;case 14:case 15:case 16:break;case 17:return 37;case 18:return 20;case 19:return 40;case 20:return 41;case 21:return 38;case 22:return 39;case 23:return 42;case 24:return 7;case 25:return 33;case 26:return 36;case 27:return 32;case 28:return 31;case 29:return 52;case 30:return this.begin("GROUP"),47;case 31:return 53;case 32:return 34;case 33:return 35;case 34:return 25;case 35:return 56;case 36:return 55;case 37:var n=this,o=n.input();if(":"!=o)return n.unput(o),"NAME";{const s=n.input(),a=n.input();if(s.match(/[ns]/i)&&a.match(/[ew]/i)||s.match(/[ensw]/i)&&(a.match(/\s/)||!a.match(/A-Za-z0-9_/)))return n.unput(a),n.unput(s),n.unput(o),"NAME";for(;;){const l=n.input();if(!l.match(/[A-Za-z_0-9]/i)){l.match(/\n/)||n.unput(l);break}}return"NAME"}case 38:return 58;case 39:return"NUMBER";case 40:return 5;case 41:console.log(t.yytext)}},rules:[/^(?:"[^"]+")/i,/^(?:\$\([^)]+\))/i,/^(?:(if\s+.*then(?=\n)))/i,/^(?:{IF_CLAUSE})/i,/^(?:(else\s*if\s+.*then(?=\n)))/i,/^(?:(else(?=\n)))/i,/^(?:(end\s*if(?=\n)))/i,/^(?:(;[^\n]+))/i,/^(?:(;[^\n]+(\n)))/i,/^(?:(actor|beginpoint|box|circle|cloud|condition|database|default|diamond|dots|doublecircle|ellipse|endpoint|input|loopin|loopout|mail|minidiamond|minisquare|note|record|roundedbox|square|terminator|loop|loopend|loopstart|rect|rectangle\b))/i,/^(?:(dotted|dashed|solid|bold|rounded|diagonals|invis|singularity\b))/i,/^(?:(\())/i,/^(?:(\)))/i,/^(?:[\n])/i,/^(?:[ \t]+)/i,/^(?:\s+)/i,/^(?:\(|\))/i,/^(?:(^\/\/[^\n]*))/i,/^(?:(,))/i,/^(?:edge color)/i,/^(?:edge textcolor|edge text color)/i,/^(?:vertex color)/i,/^(?:vertex textcolor|vertex text color)/i,/^(?:group color)/i,/^(?:(#[A-Fa-f0-9]{6}))/i,/^(?:^(landscape|horizontal|lr))/i,/^(?:^(portrait|vertical|td))/i,/^(?:equal)/i,/^(?:shape)/i,/^(?:group end|\})/i,/^(?:group|\{)/i,/^(?:start)/i,/^(?:generator)/i,/^(?:visualizer)/i,/^(?:<\/|\/>|<\.>|<->|<>|<-|<\.|<|->|\.>|>|-|\.)/i,/^(?:(\/[A-Za-z0-9]+\.png\b))/i,/^(?:(:(nw|ne|n|sw|se|s|e|w)))/i,/^(?:([A-Za-z][A-Za-z_0-9]*))/i,/^(?:([A-Za-z][A-Za-z_0-9]*))/i,/^(?:([0-9])+)/i,/^(?:$)/i,/^(?:.)/i],conditions:{GROUP:{rules:[1,7,13,14,24,38],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,8,9,10,11,12,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,39,40,41],inclusive:!0}}},new((xe.prototype=o).Parser=xe)}();"undefined"!=typeof require&&"undefined"!=typeof exports&&(exports.parser=diagrammer_parser,exports.Parser=diagrammer_parser.Parser,exports.parse=function(){return diagrammer_parser.parse.apply(diagrammer_parser,arguments)},exports.main=function(e){e[1]||(console.log("Usage: "+e[0]+" FILE"),process.exit(1));e=require("fs").readFileSync(require("path").normalize(e[1]),"utf8");return exports.parser.parse(e)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1)));