{"client_closed":"c;Client\ns;Server\n\nc-c;Handshake\nc>s;SYN\nc<s;SYN,ACK\n\nc>s;ACK\nc-c;Passing the data\nc<s;PSH,ACK\n\nc>s;ACK\nc-c;\"Time passes\"\n\nc<s;FIN,ACK\nc>s;ACK\n\nc>s;FIN,ACK\nc<s;ACK\n","server_closed":"c;Client\ns;Server\n\nc-c;Handshake\nc>s;SYN\nc<s;SYN,ACK\n\nc>s;ACK\nc-c;Passing the data\nc<s;PSH,ACK\n\nc>s;ACK\nc-c;\"Time passes\"\n\nc<s;FIN,ACK\nc>s;ACK\n\nc>s;FIN,ACK\nc<s;ACK\n ","vpn_states":"cloud e;EventBus\n\ngroup service;Pryte Vpn\n  group vpn;Dapple\\nThreads\n    roundedbox v;Vpn\n    box tpp;TnlPktProc\n  group end\n  ellipse s;Service\n  box d#ff0000;Dialog\\nStates\ngroup end\n\nd.>e;DIALOG\\nDISMISSED_*\ntpp.>e;APP_NW_\\ndropped\\nfree\\nPAYG\nvpn.>e;NO_VPN_AVAIL\n\ngroup os;OS\\nBroadcastReceivers\n c;Con\\nChngLstnr\n t;Tthrng\\nChngLstnr\n p;Phn\\nStLstnr\ngroup end\n\nc.>e;CONNECTION_\\nlost_all\\nwifi_conn\\nmobile_conn\nt.>e;tethering\\non/off\np.>e;PHONE_DATA_\\nconnected\\nconnecting\\ndisconnected\\nsuspended\ns.>e;Vpn revoked\n\ngroup tbi\n  //Unknown(to be implemented)\n  dots u.>#ff5500e;ROAMING\\nDETECTED\n  u.>e;TETHERING\\nON/OFF\n //Not used currently/anymore\n dots x1.>#ff0000e;BOOTUP\\nUSER\\nDENIED\\nVPN\\nACCESS\ngroup end","event_producers":"vertical\nequal a1,a2,a3\n\n$(vpn:#5050ff)\n$(vpni:#9090ff)\n$(os:#50ff50)\n$(tbi:#ff5000)\n$(unknown:#ff0000)\n\ncloud e;EventBus\n\ngroup service$(vpn);Pryte Vpn\n  group vpn$(vpni);Dapple\\nThreads\n    roundedbox v;Vpn\n    box tpp;TnlPktProc\n  group end\n  ellipse s;Service\n  box d#ff0000;Dialog\\nStates\n  invis a1\ngroup end\n\nd.>$(vpn)e;DIALOG\\nDISMISSED_*\ntpp.>$(vpn)e;APP_NW_\\n* dropped\\n* free\\n* PAYG\nvpn.>$(vpn)e;NO_VPN_AVAIL\nvpn.>$(vpn)e;TUNNEL\\n* connected\\n* disconnected\\n* could not conn\ns.>$(vpn)e;Vpn revoked\ns.>$(vpn)e;ProtectionMode\\nInitialize\n\n\ngroup os;OS\\nBroadcastReceivers\n  invis a2\n c;Con\\nChgLstnr\n t;Tether\\nChgLstnr\n p;Phn\\nStLstnr\n  group tbi;to be implemented\n    //Unknown(to be implemented)\n    dots t1.>$(tbi)e;ROAMING\\nDETECTED\n    dots t2.>$(tbi)e;DATA_SIM_CHANGED\n  group end\ngroup end\n\n t.>$(os)e;TETHERING\\nON/OFF\n c.>$(os)e;CONNECTION_\\n* lost_all\\n* wifi_conn\\n* mobile_conn\n p.>$(os)e;PHONE_DATA_\\n* connected\\n* connecting\\n* disconnected\\n* suspended\n\ngroup unk;Unknown\\nor not used\n  invis a3\n //Not used currently/anymore\n dots u1.>$(unknown)e;BOOTUP\n dots u2.>$(unknown)e;DENIED_VPN_ACCESS\ngroup end\n\n","base_sim":"conf;CONFIGURATION_CHANGED\nps;PHONE_STATE\ncc;CONNECTIVITY_CHANGE\nss;SERVICE_STATE\nssc;SIM_STATE_CHANGED\ntm;TelephonyManager\nv;Pryte Vpn\nv-v;All SIMS disabled\nv-v;Enable SIM1/Vectone\n","enable_vectone":"  //AUTOGEN\n //Describe the test case\n cc;CONNECTIVITY_CHANGE\n ss;SERVICE_STATE\n ssc;SIM_STATE_CHANGED\n tm;TelephonyManager\n v;Pryte Vpn\n v-v;Sony XPeria MultiTipo\n v-v;All sims disabled\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_ABSENT(1)\\nroam:false\n v-v;Enable vectone(sonera as active datasim)\n ssc>v;ss=UNKNOWN\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_UNKNOWN(0)\\nroam:false\n ssc>v;ss=IMSI\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_UNKNOWN(0)\\nroam:false\n ssc>v;ss=LOADED\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ssc>v;ss=READY\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ssc>v;ss=IMSI\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n tm>tm;simOp:\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n v-v;7 seconds passed\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ssc>v;ss=LOADED\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n cc>v;networkInfo=NetworkInfo: type: mobile[EDGE], state: CONNECTED/CONNECTED, reason: dataAttached, extra: webfi.mundio.com, roaming: true, failover: false, isAvailable: true\\nreason=dataAttached\\nextraInfo=webfi.mundio.com\\ninetCondition=0\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\nv-v;Enable SONERA SIM\n ssc>v;ss=UNKNOWN\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ssc>v;ss=IMSI\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ssc>v;ss=LOADED\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ssc>v;ss=LOCKED\\nsubscription=1\\nphoneName=Phone\\nreason=PIN\\nattempts=3\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\nv-v;Asking PIN\n v-v;38 seconds passed\n ssc>v;ss=UNKNOWN\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n conf>v;-\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ssc>v;ss=READY\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ssc>v;ss=IMSI\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n ssc>v;ss=LOADED\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n tm>tm;simOp:24411\\nnetOp:\\nsimState:SIM_STATE_READY(5)\\nroam:false\n v-v;9 seconds passed\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n cc>v;networkInfo=NetworkInfo: type: mobile[EDGE], state: DISCONNECTED/DISCONNECTED, reason: (unspecified), extra: webfi.mundio.com, roaming: true, failover: false, isAvailable: false\\nextraInfo=webfi.mundio.com\\nnoConnectivity=true\\ninetCondition=0\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n v-v;6 seconds passed\n cc>v;networkInfo=NetworkInfo: type: mobile[UNKNOWN], state: CONNECTED/CONNECTED, reason: dataAttached, extra: internet, roaming: false, failover: false, isAvailable: true\\nreason=dataAttached\\nextraInfo=internet\\ninetCondition=0\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=9\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n\n","change_datasim":"//AUTOGEN\n //All sims disabled, vectone enabled\n cc;CONNECTIVITY_CHANGE\n ss;SERVICE_STATE\n ssc;SIM_STATE_CHANGED\n tm;TelephonyManager\n v;Pryte Vpn\n v-v;All SIMS enabled\n v-v;Sonera as preferred DATA Sim\n v-v;Set vectone as preferred DATA sim\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=0\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n cc>v;networkInfo=NetworkInfo: type: mobile[UNKNOWN], state: DISCONNECTED/DISCONNECTED, reason: (unspecified), extra: internet, roaming: false, failover: false, isAvailable: false\\nextraInfo=internet\\nnoConnectivity=true\\ninetCondition=0\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n v-v;7 seconds passed\n cc>v;networkInfo=NetworkInfo: type: mobile[EDGE], state: CONNECTED/CONNECTED, reason: dataAttached, extra: webfi.mundio.com, roaming: true, failover: false, isAvailable: true\\nreason=dataAttached\\nextraInfo=webfi.mundio.com\\ninetCondition=0\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n v-v;36 seconds passed\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\nv-v;Change Sonera as Datasim\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n cc>v;networkInfo=NetworkInfo: type: mobile[EDGE], state: DISCONNECTED/DISCONNECTED, reason: (unspecified), extra: webfi.mundio.com, roaming: true, failover: false, isAvailable: false\\nextraInfo=webfi.mundio.com\\nnoConnectivity=true\\ninetCondition=0\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n cc>v;networkInfo=NetworkInfo: type: mobile[UNKNOWN], state: CONNECTED/CONNECTED, reason: dataAttached, extra: internet, roaming: false, failover: false, isAvailable: true\\nreason=dataAttached\\nextraInfo=internet\\ninetCondition=0\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=9\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n v-v;17 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n v-v;33 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n v-v;10 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=9\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n v-v;51 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n v-v;7 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=9\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n tm>tm;simOp:24411\\nnetOp:24412\\nsimState:SIM_STATE_READY(5)\\nroam:true\n","simplified_datasim_change":"//AUTOGEN\n //All sims disabled, vectone enabled\n cc;CONNECTIVITY_CHANGE\n ss;SERVICE_STATE\n ssc;SIM_STATE_CHANGED\n tm;TelephonyManager\n v;Pryte Vpn\n v-v;All SIMS enabled\n v-v;Sonera as preferred DATA Sim\n v-v;Set vectone as preferred DATA sim\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=0\\nroaming=false\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n cc>v;networkInfo=NetworkInfo: type: mobile[UNKNOWN], state: DISCONNECTED/DISCONNECTED, reason: (unspecified), extra: internet, roaming: false, failover: false, isAvailable: false\\nextraInfo=internet\\nnoConnectivity=true\\ninetCondition=0\n v-v;7 seconds passed\n cc>v;networkInfo=NetworkInfo: type: mobile[EDGE], state: CONNECTED/CONNECTED, reason: dataAttached, extra: webfi.mundio.com, roaming: true, failover: false, isAvailable: true\\nreason=dataAttached\\nextraInfo=webfi.mundio.com\\ninetCondition=0\n v-v;36 seconds passed\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\nv-v;Change Sonera as Datasim\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n cc>v;networkInfo=NetworkInfo: type: mobile[EDGE], state: DISCONNECTED/DISCONNECTED, reason: (unspecified), extra: webfi.mundio.com, roaming: true, failover: false, isAvailable: false\\nextraInfo=webfi.mundio.com\\nnoConnectivity=true\\ninetCondition=0\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n cc>v;networkInfo=NetworkInfo: type: mobile[UNKNOWN], state: CONNECTED/CONNECTED, reason: dataAttached, extra: internet, roaming: false, failover: false, isAvailable: true\\nreason=dataAttached\\nextraInfo=internet\\ninetCondition=0\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=9\\nroaming=false\n v-v;17 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n v-v;33 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n v-v;10 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=9\\nroaming=false\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n v-v;51 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n v-v;7 seconds passed\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=9\\nroaming=false\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n","simplified_sim_enable":"  //AUTOGEN\n //Describe the test case\nconf;CONFIGURATION_CHANGE\n cc;CONNECTIVITY_CHANGE\n ss;SERVICE_STATE\n ssc;SIM_STATE_CHANGED\n v;Pryte Vpn\n v-v;Sony XPeria MultiTipo\n v-v;All sims disabled\n v-v;Enable vectone(sonera as active datasim)\n ssc>v;ss=UNKNOWN\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n ssc>v;ss=IMSI\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n ssc>v;ss=LOADED\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n ssc>v;ss=READY\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n ssc>v;ss=IMSI\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n v-v;7 seconds passed\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n ssc>v;ss=LOADED\\nsubscription=0\\nphoneName=Phone\\nreason=\\nattempts=-1\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n cc>v;networkInfo=NetworkInfo: type: mobile[EDGE], state: CONNECTED/CONNECTED, reason: dataAttached, extra: webfi.mundio.com, roaming: true, failover: false, isAvailable: true\\nreason=dataAttached\\nextraInfo=webfi.mundio.com\\ninetCondition=0\nv-v;Enable SONERA SIM\n ssc>v;ss=UNKNOWN\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n ssc>v;ss=IMSI\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n ssc>v;ss=LOADED\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n ssc>v;ss=LOCKED\\nsubscription=1\\nphoneName=Phone\\nreason=PIN\\nattempts=3\nv-v;Asking PIN\n v-v;38 seconds passed\n ssc>v;ss=UNKNOWN\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n conf>v;-\n ssc>v;ss=READY\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=0\\nroaming=false\n ssc>v;ss=IMSI\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=0\\nroaming=false\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=0\\nroaming=false\n ss>v;operator-numeric=\\noperator-alpha-short=\\nradioTechnology=0\\nroaming=false\n ssc>v;ss=LOADED\\nsubscription=1\\nphoneName=Phone\\nreason=\\nattempts=3\n v-v;9 seconds passed\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=2\\nroaming=true\n cc>v;networkInfo=NetworkInfo: type: mobile[EDGE], state: DISCONNECTED/DISCONNECTED, reason: (unspecified), extra: webfi.mundio.com, roaming: true, failover: false, isAvailable: false\\nextraInfo=webfi.mundio.com\\nnoConnectivity=true\\ninetCondition=0\n ss>v;operator-numeric=24412\\noperator-alpha-short=DNA\\nradioTechnology=0\\nroaming=true\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=3\\nroaming=false\n v-v;6 seconds passed\n cc>v;networkInfo=NetworkInfo: type: mobile[UNKNOWN], state: CONNECTED/CONNECTED, reason: dataAttached, extra: internet, roaming: false, failover: false, isAvailable: true\\nreason=dataAttached\\nextraInfo=internet\\ninetCondition=0\n ss>v;operator-numeric=24491\\noperator-alpha-short=FI SONERA\\nradioTechnology=9\\nroaming=false\n\n","VpnAppModel":"generator digraph\nvisualizer fdp\n$(DM:#ff0000)\n$(DM_ACCT:#ffFF00)\n$(DM_PROD:#55FFF0)\n$(VPN:#00ff00)\n$(BACK:#5555ff)\n$(EVENT:#ff00ff)\nshape box\n//EventRecorder path\nnode color $(EVENT)\nAndroid-EventRecorder-Queue,Uploader\n//BackendApiServicePart\nnode color $(BACK)\nAndroid-BackendApiService-BackendBootstrapHelper,BootstrapListener\n//VpnService\nnode color $(VPN)\nAndroid-VpnService-DropProcessor,AppDetection,VpnThread-VpnProtocol\n//DomainModel immediates\nnode color $(DM)\nAndroid-DomainModel-DepencencyDb,DapplePurchaser,DappleRecommender,Accounting,Product\n//Domain model accounting\nnode color $(DM_ACCT)\nAccounting-DataUsePreferenceStore,DataUseReporter,AccountedUid-RoutingGroup\n//Domain model product\nnode color $(DM_PROD)\nProduct-Branding,DetectedOperator,PromoDapple,ActiveDapple,Dapple-DappleApp,PurchaseOptions\n","VpnClientDesign":"shape box\nvertical\nnode color $(gray:#c0c0c0)\n\nModel\nBackend\nVpnService\nApplication\n\nnode color $(cyan:#99ffff)\n\nModel-DapplePurchaser,DappleRecommender,DependencyDb,DomainModel,Accounting\n\nAccounting-DataUsePreferenceStore,DataUseReported,AccountedUid-RoutingGroup\nnode color $(lightgreen:#ccffcc)\nProduct-Branding,ActiveDapple/cpu.png,PromoDapple,DetectedOperator,Dapple-PurchaseOption,DappleApp\n\nnode color $(lightyellow:#ffffcc)\nBackend-BackendApiService,BackendBootstrapHelper,BootstrapListeners\nVpnService-AppDetection,DropProcessor,Routing,VpnThread-VpnProtocol\n\nnode color $(lightpurple:#ffcccc)\nApplication-DappleApplication,Bus,CommonActivity,CommonFragmentActivity,EventRecorder-Persistence,Uploader\n\n","DappleMode":"\n//MIND MAP PART\n$(events:#ffc0ff) $(pd:#ffc0c0) $(state:#ccffcc)\n$(vpn:#c0ffff) $(def:#c0c0c0) $(error:#ff0000) $(async:#9990ff) node color $(def)\n $(single:#0000ff) $(thread:#aaccaa)\n$(sb8:#ff0000) $(snative:#ff00ff)\n\n//MINDMAP PART in DappleModeMindMap\n//ACTUAL STATE DESCRIPTION\nstart begin\nbegin>breakAllThreads\n//Async ask vpn permissions\n//As long as we're here, mobile data is ON\n\ngroup FetchBootstrap;Fetch bootstrap from dc\n    cloud bs $(async);Make bootstrap request\n    bs.>$(error)bs;Retry until success\ngroup end\n\n//group Entry;Main entry point\n    //VpnGranted\n    //group LaunchVpn#ccffcc;Prepare vpn\n    //    breakAllThreads.>Wait.>\"granted\"VpnGranted\n    //    group vpnprep#ccccff;Async\n    //        diamond startVpn;VpnService.prepare()\n    //        breakAllThreads.>startVpn>\"show intent\"showIntent>$(error)\"Cancelled\\nRevoked\"startVpn\n    //        startVpn>VpnGranted\n    //    group end\n    //group end\n\n    group ConnectB8;Connect to b8\\n(*Actually this is b8 reader thread)\n        blackhole>bs>Connect2B8>AuthNegotiate>ReconfigureVpn.>StartThreads\n    group end\n//group end\n\n\n//See Asynch error processing\n//group MainMode;Main processing\\nEach group = one thread\n    group StackLoop$(thread);Run the user space TCP stack&timers\n        runUserSpaceStackLoop\n        shape input\n        runUserSpaceStackLoop.>InFree,InNonFree,\n                                        PrtctSocket,SendTcp,\n                                        SendUdp,SendWinUpd\n        shape default\n        cloud UdpOut$(async).>invis udp1\n        cloud TcpOut$(async).>invis tcp1\n    group end\n\n    group TunnelComms$(thread);Read from native stack (tunnel)\n        invis n1 .>\n        cloud readFromNativeSide$(snative).>\"Continous feed\"RoutingLogic/>$(single)\"PIPE\\nsingle thread access\\nfree\"StackLoop\n        RoutingLogic/>$(single)\"nonfree\"StackLoop\n    group end\n\n    group BackendComms$(thread);Read from B8\\n(*)\n        invis b1 .> cloud readFromBackend$(sb8)>ParseB8 >\n              \"Some\\nadministrative\\nmessages\"AdminWork>\"loop\"readFromBackend\n        ParseB8 />$(single) StackLoop;PIPE\\nsingle thread access\n    group end\n//group end\n\ngroup ConnectionBrokenGroup;Examine why connection broke\n    //Some connection errors MUST make bootstrap request, some quick reconnect\n    connectionBroken>SimChanged,IpChanged,IoError,LostRadio,DataSuspended\n    SimChanged,IpChanged>bs\n    IoError>Connect2B8\n    LostRadio,DataSuspended.>loop WaitTillRdAvail>bs\ngroup end\n\n//loose ends\nReconfigureVpn>BackendComms\n\n//VpnGranted>blackhole\nbreakAllThreads>blackhole\n//AdminWork>\"break all threads\"bs\n\nInFree,InNonFree.>cloud Write2Native$(snative).>invis i1\n\nSendUdp,SendTcp,SendWinUpd.>SendVCodes.>cloud Write2B8$(sb8).>invis i2\n\n//Timed events\nnode color $(def)\nnote Every24Hours.>$(async)bs;No retry?\n\n//Asynch error processing\nnode color $(error)\nlink color $(error)\nStackLoop.>\"Exception caught\"Errors\nVpnRevoked.>\"User revoked vpn\"Errors.>begin\nBackendComms.>\"B8 connection broken\"connectionBroken\nTunnelComms.>\"Any error\"Errors\n","DappleModeMindMap":"note x;- Internal and external events\\naffecting the DappleMode\\n- External events affect\\nthe DappleMode indirectly\n//MIND MAP PART \n$(events:#ffc0ff) $(pd:#ffc0c0) $(state:#ccffcc)\n$(vpn:#c0ffff) $(def:#c0c0c0) $(error:#ff0000)\n$(async:#0000ff)\nnode color $(def)\n\nEvents$(events);Possible events\\nDappleMode is interested\nExternalEvents-note UserToggledMobileData\n\n//EXTERNAL EVENTS indirectly affecting DappleMode \ndiamond ExternalEvents-\"INDIRECTLY\"Events\n\n//Wifi changes\nExternalEvents<-\"Wifi\\nchange\"note Wifi-On,Off\n\n//Phone data changes\nnode color $(pd)\nshape input\nExternalEvents<-\"Phone\\ndata\\nchange\"PhoneData-Connected,Connecting,Disconnecting$(error),Suspended\nExternalEvents<-\"mobile\\nsignal\\nstrength\"Signal,\" \"RadioLost$(error)\n\n//Sim changes\nshape box\nnode color $(def)\nExternalEvents<-SimChanges<.\"radioTechnology\"ServiceStateChanged,\"Cannot\\nreally\\ndetect\"note DataSimChanged\n\n//Tethering changes\nExternalEvents<-Tethering\n\n//DIRECT EVENTS\nnode color $(state)\nshape box\nEvents-StateTransitions-TurnOn,TurnOff-ProtectionModeChanged\n\nnode color $(vpn)\nEvents-\"Must be granted\"VpnAccess-Granted,Asking,Cancelled$(error),Revoke$(error)-Disconnect$(error)\n\nEvents-ConnectionErrors-$(error)B8SocketErr$(error),TunnelErr$(error),Bootstrap$(error)\n","DappleState":"$(state:#0000ff)\nshape note\n\ngroup StartupWizard;StartupWizard\n  eStartupWizard;entry\ngroup end\n\ngroup DoNothing;DoNothing\n  eDoNothing;entry\ngroup end\n\ngroup NoVpnAccess;NoVpnAccess\n  eNoVpnAccess;entry\ngroup end\n\ngroup Dapple;Dapple\\nMode\n  eDapple;entry\n  eDapple>VpnPrepare>BootStrap>\"retry\"BootStrap,ConnectVpn>\"IP Change\"BootStrap,\"B8 error\\nreopen\"ConnectVpn\n  invis errDappleMode\n  errDappleMode.>\"Wifi on |\\nTethering\"KillThreads>Wait>VpnPrepare\ngroup end\n\n\nStartupWizard>Dapple\nStartupWizard>DoNothing\nDapple>DoNothing\nDapple>NoVpnAccess\n\nlink color #ff0000\nVpnPrepare.>\"Must show\\ndialog\"NoVpnAccess\nerrDappleMode.>\"Vpn\\nRevoked\"NoVpnAccess\n","NewState":"//Guardian thread state machine as it is right now\n//Failure drops not depicted, will transition to NoVpnAccess\n//DoConnect initialized VPN stuff and starts trying to connect to backend\n\n$(blue:#c0c0ff)\n$(GVAR:#00c000)\n$(PG:#00c0c0)\n$(D:#ff0000)\n$(def:#000000)\n\nD$(blue);DISCONNECTED\nDING$(blue);DISCONNECTING\nC$(blue);CONNECTED\nCING$(blue);CONNECTING\nA$(blue);ASKING_PERMISSION\n\n//GET_VPN_ACCESS_RIGHTS\nlink color $(GVAR)\nC>\"GET_VPN_ACCESS_RIGHTS\"C\nCING>\"GET_VPN_ACCESS_RIGHTS\"CING\nA>\"GET_VPN_ACCESS_RIGHTS\"A\nD,DING>\"GET_VPN_ACCESS_RIGHTS\"dots AP>A\nAP.>dotted box AskPermission->$(def)\"Send\\nevent\\nPermission given\"dots P\n\n//PERMISSION_GIVEN\nlink color $(PG)\nA>\"PERMISSION_GIVEN\"dotted box DoConnect->$(def)\"Connected\"C\nD:n>\"PERMISSION_GIVEN\"D:n\nDING:n>\"PERMISSION_GIVEN\"DING:n\nC>\"PERMISSION_GIVEN\"C:s\nCING>\"PERMISSION_GIVEN\"CING:ne\n\n//DISCONNECT\nlink color $(D)\nA,C,CING>\"DISCONNECT\"dotted box DoDisconnect->$(def)\"Disconnected\"D\n\nlink color $(def)\n//Specials\ndashed terminator EXIT;EXIT\\nNoVpnAccess\nDoConnect>#ff0000\"Fatal VPN\\ninit\\nerror\"EXIT\nP>#ff0000\"no\\nperm\"EXIT\n","DappleCentral":"node color #cacaca\n{XLG\nXL\n}\nmongodb redis BlaastRedis-ChargingService-XL\n{dcg;dc\n    b8 haproxy>dc,BlaastRedis,redis,mongodb\n    mulauncher nginx\n}\ndots x-nginx;http\\n0 rated\\nmsisdn header\ndots y-b8;0+rated\\ip address\n\n//overview of DC\nnode color #cacaff\ndcn#ffcaca;DappleCentral\ndcn-LoggingAnalytics,DappleStore,UserStore,ChargingServices,PurchaseHistory,B8Accounting,ClientWebServiceApi,\nEnvironmentConfig#caffca,Products#caffff,WebTool#ffffca\nnode color #ffffca\nWebTool-ToolUserStore,StaticAssets-JsHtmlCss\nnode color #caffca\nEnvironmentConfig-MongoRedis,ChargingEndpoint\nnode color #caffff\nProducts-Branding,Dapples-BannerAssets\n"}