{"filename":"//Blaast TCP output\nbs;BlaastStack\nc;CWrapper\ns;SlirpInterface\nio;ip_output\nto;tcp_output\n\n","output":"bs;BlaastStack\nc;CWrapper\ns;SlirpInterface\nii;ip_input\nti;tcp_input\nts;tcp_subr\nbs>s;outgoingip\ns>ii;ip_input\nii>ti;tcp_input\nti>ts;tcp_fconnect\nts>c;bindSocketToInterface\nc<>bs;bindSocketToInterface\nts<c ti<ts ii<ti s<ii bs<s \n","input":"bs;BlaastStack\nc;CWrapper\ns;SlirpInterface\nio;ip_onput\nto;tcp_output\n\n","tcp":"\nshape box\nclosed#ff0000;CLOSED\nclosed_end#ff0000;closed\\nBack to start\nlisten#ffff00;LISTEN\nsyn_received#888888;SYN\\nRECEIVED\nsyn_sent#888888;SYN\\nSENT\nestablished#00ff00;ESTABLISHED\\ndata xchange occurs\n\ngroup PassiveClose#afeeee;Passive CLOSE\n  close_wait#ffff00;CLOSE WAIT\n  last_ack#ffff00;LAST ACK\ngroup end\n\ngroup ActiveClose#afeeee;Active CLOSE\n  fin_wait1#ffff00;FIN WAIT 1\n  closing#ffff00;CLOSING\n  fin_wait2#ffff00;FIN WAIT 2\n  time_wait#ffff00;TIME WAIT\ngroup end\n\n//unusual event\nsyn_sent.>closed;CLOSE/-\nsyn_sent.>syn_received;SYN/SYN+ACK\\n(simultaneous open)\nlisten.>syn_sent;SEND/SYN\nlisten.>closed;CLOSE/-\nsyn_received.>listen;RST/-\nsyn_received.>fin_wait1;CLOSE/FIN\nfin_wait1.>closing;FIN/ACK\nfin_wait1.>time_wait;FIN+ACK/ACK\nclosing.>time_wait\n\n// client / receiver path\nclosed>#ff0000syn_sent;CONNECT/SYN(1/3 of 3w/hs)\nsyn_sent>#ff0000established;SYN+ACK/ACK(3/3 of 3w/hs)\nestablished>#ff0000fin_wait1;CLOSE/FIN\nfin_wait1>#ff0000fin_wait2;ACK/-\nfin_wait2>#ff0000time_wait;FIN/ACK\ntime_wait>#ff0000closed_end;Timeout\n\n// server / sender path\nclosed>#0000fflisten;LISTEN/-\nlisten>#0000ffsyn_received;SYN/SYN+ACK(2/3 of 3w/hs)\nsyn_received>#0000ffestablished;ACK/-\nestablished>#0000ffclose_wait;FIN/ACK\nclose_wait>#0000fflast_ack;CLOSE/FIN\nlast_ack>#0000ffclosed_end\n","slirp":"//UDP Sending from PHONE to NETWORK depicted\ngroup PhoneJava\n  senddata#7777ff;Send data\ngroup end\n\ngroup IPInput\n  ip_input#9977ff \n  senddata>ip_input\ngroup end \n\ngroup TcpInput\n  tcp_input#9977ff\n  shape diamond\n  foundtcp#77ff77\n  shape default\n  tcp_input>foundtcp>connect\ngroup end\n  \ngroup Icmp\n  icmp_input#9977ff\n  icmp_error#9977ff\ngroup end\n\ngroup Udp\n  udp_input#9977ff\n  findudp_so;Find UDP\n  shape diamond\n  foundudp#77ff77;Found\n  udp_emu#77ff77\n  shape default\n  udpseen;seen\n  udpnew;Create SO\n  sosendto\n  udp_input> findudp_so\n  findudp_so>foundudp\n  foundudp>udpnew,udpseen\n  udpseen,udpnew>udp_emu\n  udp_emu>sosendto\n  sosendto>icmp_error\ngroup end\n\ngroup b8;Temporary B8 routing\n b8udpwrap#779999\n b8tcpwrap#779999\n udp_input>b8udpwrap;IF b8 traffic\n tcp_input>b8tcpwrap;IF b8 traffic\ngroup end\n\nip_input>tcp_input,udp_input,icmp_input\n","slirp_mainloop":"start main_loop\nip_slowtimo;ip_slowtimo\\nIP Timer process, free expired fragments\ntcp_fasttimo;tcp_fasttimo\\nProcess delayed ACKs\ntcp_slowtimo;tcp_slowtimo\\nper500ms\\nupdate timers\\nFSM actions\ndomainsockets;Read domain sockets\\ncall ip_input\nmain_loop>initSelect>select>tcp_fasttimo>tcp_output>ip_slowtimo\nip_slowtimo>tcp_slowtimo>domainsockets \ndomainsockets<>ip_input\n\ngroup checkSocketsGroup\nshape loopin\nscansockets\nshape default\nscansockets>sorecvoob>tcp_connect>soread>ctcp_output>tcp_input>sowrite\nshape loopout\ncheckSocketsDone\nshape default\nsowrite>checkSocketsDone \ngroup end\n\ndomainsockets>checkSocketsGroup \n\ncheckSocketsDone>receiveUdpPackets>main_loop\n","slirp_incoming_udp":"//UDP Sending from PHONE to NETWORK depicted\n\ngroup socket;Socket\n  sorecvfrom\ngroup end\n \ngroup Udp\n //INCOMING to TCP\n udp_output#00bfff \ngroup end\n\ngroup IPOutput\n  ip_output#9977ff \ngroup end \n\ngroup PhoneJava\n  udpFromB8#00ffee\ngroup end\n\ngroup IF\n  if_output#9977ff \n  if_start#9977ff\ngroup end \n\ngroup b8;Temporary B8 routing\n  handleIncomingNonFree#ffee00\ngroup end\n\nsorecvfrom>udp_output>ip_output>if_output>if_start>handleIncomingNonFree \nudpFromB8>ip_output"}