function plantuml_sequence(yy){var depth=0;function indent(msg){if(msg.trim()=="")return"";var prefix="";for(var i=0;i<depth;i++){prefix+="  "}return prefix+msg}var processANode=function(o){var nattrs=[];var styles=[];getAttrFmt(o,"style","{0}",styles);if(styles.length>0){if(styles.join("").indexOf("singularity")!==-1){nattrs.push('shape="circle"');nattrs.push('label=""');nattrs.push("width=0.01");nattrs.push("weight=0.01")}else{nattrs.push('style="'+styles.join(",")+'"')}}getAttrFmt(o,"image",'image="icons{0}"',nattrs);getAttrFmt(o,"textcolor",'fontcolor="{0}"',nattrs);var r=getShape(shapes.digraph,o.shape,'shape="{0}"');if(r){nattrs.push(r)}var t="";if(nattrs.length>0)t="["+nattrs.join(",")+"]";yy.result(indent("participant "+getAttrFmt(o,"label",'"{0}" as')+" "+o.getName()+t))};var r=getGraphRoot(yy);if(r.getVisualizer()){yy.result("/* render:"+r.getVisualizer()+"*/")}yy.result("@startuml");yy.result("autonumber");var s=r.getStart();if(s!=undefined&&s!=""){var fwd=getNode(yy,s);processANode(fwd)}var printLinks=function printLinks(container){for(var i in yy.LINKS){var l=yy.LINKS[i];if(l.printed)continue;if(l.container!==container)break;l.printed=true;var attrs=[];var note="";var label=getAttr(l,"label");if(label){if(label.indexOf("::")!==-1){label=label.split("::");note=label[1].trim()}}var color=getAttrFmt(l,"color","[{0}]").trim();var lt;var lr=l.right;var ll=l.left;if(lr instanceof Group){lr=lr.OBJECTS[0];if(lr==undefined){}}if(ll instanceof Group){ll=ll.OBJECTS[0];if(ll==undefined){}}if(l.linkType.indexOf("/")!==-1){}var dot=false;var dash=false;var broken=false;if(l.linkType.indexOf(".")!==-1){dot=true}else if(l.linkType.indexOf("-")!==-1){dash=true}else if(l.linkType.indexOf("/")!==-1){}var swap=false;if(l.linkType.indexOf("<")!==-1&&l.linkType.indexOf(">")!==-1){lt=(dot?"-":"")+"-"+color+">";swap=true}else if(l.linkType.indexOf("<")!==-1){var tmp=ll;ll=lr;lr=tmp;lt=(dot?"-":"")+"-"+color+">"}else if(l.linkType.indexOf(">")!==-1){lt=(dot?"-":"")+"-"+color+">"}else if(dot){yy.result(getAttrFmt(l,"label","...{0}..."));continue}else if(dash){yy.result(getAttrFmt(l,"label","=={0}=="));continue}else{lt="-"+color+">"}var t="";if(label)label=":"+label;else label="";yy.result(indent(ll.getName()+lt+lr.getName()+t+label));if(swap)yy.result(indent(lr.getName()+lt+ll.getName()+t+label));if(note!=""){yy.result(indent("note over "+lr.getName()));yy.result(note.replace(/\\n/g,"\n"));yy.result(indent("end note"))}}};var traverseObjects=function traverseObjects(r){for(var i in r.OBJECTS){var o=r.OBJECTS[i];if(o instanceof Node)processANode(o)}printLinks(r);for(var i in r.OBJECTS){var o=r.OBJECTS[i];if(o instanceof Group){var processAGroup=function(o){debug(JSON.stringify(o));var cond=getAttr(o,"conditional");if(cond){if(cond=="if")cond="alt";else if(cond=="elseif")cond="else";else if(cond=="else")cond="else";else if(cond=="endif")cond="end"}else{cond="ref"}yy.result(indent(cond+" "+o.getLabel()));if(o.getColor()!==undefined){yy.result(indent("style=filled;"));yy.result(indent(getAttrFmt(o,"color",'   color="{0}";\n')))}depth++;traverseObjects(o);printLinks(o);depth--}(o)}else if(!o instanceof Node){throw new Error("Not a node nor a group, NOT SUPPORTED")}}}(r);printLinks(r);yy.result("@enduml")}