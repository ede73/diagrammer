{"filename":"//Blaast TCP output\nbs;BlaastStack\nc;CWrapper\ns;SlirpInterface\nio;ip_output\nto;tcp_output\n\n","output":"//UDP Sending from PHONE to NETWORK depicted\n$(purple:#9977ff)\ngroup socket;Socket\n  sorecvfrom\ngroup end\n \ngroup Udp\n //INCOMING to TCP\n udp_output#00bfff \ngroup end\n\ngroup IPOutput\n  ip_output$(purple)\ngroup end \n\ngroup PhoneJava\n  udpFromB8#00ffee\ngroup end\n\ngroup IF\n  if_output$(purple) \n  if_start$(purple)\ngroup end \n\ngroup b8;Temporary B8 routing\n  handleIncomingNonFree#ffee00\ngroup end\n\nsorecvfrom>udp_output>ip_output>if_output>if_start>handleIncomingNonFree \nudpFromB8>ip_output","input":"bs;BlaastStack\nc;CWrapper\ns;SlirpInterface\nio;ip_onput\nto;tcp_output\n\n","tcp":"$(red:#ff0000)\n$(blue:#0000ff)\n$(yellow:#ffff00)\n \nshape box\nclosed$(red);CLOSED\nclosed_end$(red);closed\\nBack to start\nlisten$(yellow);LISTEN\nsyn_received$(grey:#888888);SYN\\nRECEIVED\nsyn_sent$(grey);SYN\\nSENT\nestablished#00ff00;ESTABLISHED\\ndata xchange occurs\n\ngroup PassiveClose$(lightblue:#afeeee);Passive CLOSE\n  close_wait$(yellow);CLOSE WAIT\n  last_ack$(yellow);LAST ACK\ngroup end\n\ngroup ActiveClose$(lightblue);Active CLOSE\n  fin_wait1$(yellow);FIN WAIT 1\n  closing$(yellow);CLOSING\n  fin_wait2$(yellow);FIN WAIT 2\n  time_wait$(yellow);TIME WAIT\ngroup end\n\n//unusual event\nsyn_sent.>closed;CLOSE/-\nsyn_sent.>syn_received;SYN/SYN+ACK\\n(simultaneous open)\nlisten.>syn_sent;SEND/SYN\nlisten.>closed;CLOSE/-\nsyn_received.>listen;RST/-\nsyn_received.>fin_wait1;CLOSE/FIN\nfin_wait1.>closing;FIN/ACK\nfin_wait1.>time_wait;FIN+ACK/ACK\nclosing.>time_wait\n\n// client / receiver path\nclosed>$(red)syn_sent;CONNECT/SYN(1/3 of 3w/hs)\nsyn_sent>$(red)established;SYN+ACK/ACK(3/3 of 3w/hs)\nestablished>$(red)fin_wait1;CLOSE/FIN\nfin_wait1>$(red)fin_wait2;ACK/-\nfin_wait2>$(red)time_wait;FIN/ACK\ntime_wait>$(red)closed_end;Timeout\n\n// server / sender path\nclosed>$(blue)listen;LISTEN/-\nlisten>$(blue)syn_received;SYN/SYN+ACK(2/3 of 3w/hs)\nsyn_received>$(blue)established;ACK/-\nestablished>$(blue)close_wait;FIN/ACK\nclose_wait>$(blue)last_ack;CLOSE/FIN\nlast_ack>$(blue)closed_end","slirp":"//UDP Sending from PHONE to NETWORK depicted\ngroup PhoneJava\n  senddata#7777ff;Send data\ngroup end\n\ngroup IPInput\n  ip_input$(purple:#9977ff)\n  senddata>ip_input\ngroup end \n\ngroup TcpInput\n  tcp_input$(purple)\n  shape diamond\n  foundtcp#77ff77\n  shape default\n  tcp_input>foundtcp>connect\ngroup end\n  \ngroup Icmp\n  icmp_input$(purple)\n  icmp_error$(purple)\ngroup end\n\ngroup Udp\n  udp_input$(purple)\n  findudp_so;Find UDP\n  shape diamond\n  foundudp#77ff77;Found\n  udp_emu#77ff77\n  shape default\n  udpseen;seen\n  udpnew;Create SO\n  sosendto\n  udp_input> findudp_so\n  findudp_so>foundudp\n  foundudp>udpnew,udpseen\n  udpseen,udpnew>udp_emu\n  udp_emu>sosendto\n  sosendto>icmp_error\ngroup end\n\ngroup b8;Temporary B8 routing\n b8udpwrap#779999\n b8tcpwrap#779999\n udp_input>b8udpwrap;IF b8 traffic\n tcp_input>b8tcpwrap;IF b8 traffic\ngroup end\n\nip_input>tcp_input,udp_input,icmp_input ","slirp_mainloop":"start main_loop\nip_slowtimo;ip_slowtimo\\nIP Timer process, free expired fragments\ntcp_fasttimo;tcp_fasttimo\\nProcess delayed ACKs\ntcp_slowtimo;tcp_slowtimo\\nper500ms\\nupdate timers\\nFSM actions\ndomainsockets;Read domain sockets\\ncall ip_input\nmain_loop>initSelect>select>tcp_fasttimo>tcp_output>ip_slowtimo\nip_slowtimo>tcp_slowtimo>domainsockets \ndomainsockets<>ip_input\n\ngroup checkSocketsGroup\nshape loopin\nscansockets\nshape default\nscansockets>sorecvoob>tcp_connect>soread>ctcp_output>tcp_input>sowrite\nshape loopout\ncheckSocketsDone\nshape default\nsowrite>checkSocketsDone \ngroup end\n\ndomainsockets>checkSocketsGroup \n\ncheckSocketsDone>receiveUdpPackets>main_loop\n","slirp_incoming_udp":"//UDP Sending from PHONE to NETWORK depicted\n$(purple:#9977ff)\ngroup socket;Socket\n  sorecvfrom\ngroup end\n \ngroup Udp\n //INCOMING to TCP\n udp_output#00bfff \ngroup end\n\ngroup IPOutput\n  ip_output$(purple)\ngroup end \n\ngroup PhoneJava\n  udpFromB8#00ffee\ngroup end\n\ngroup IF\n  if_output$(purple)\n  if_start$(purple)\ngroup end \n\ngroup b8;Temporary B8 routing\n  handleIncomingNonFree#ffee00\ngroup end\n\nsorecvfrom>udp_output>ip_output>if_output>if_start>handleIncomingNonFree \nudpFromB8>ip_output","slirphigh":"$(nt:#00ff00)\n$(b8:#5050ff)\n$(a:#ffff00)\n$(r:#ff0000)\n\nbox b8$(b8)\nbox remote\n\n{phone\ndiamond app1$(b8)\ndiamond app2$(nt)\nbox native\nfree$(b8)\nnative>\n  \"ip\\n0\"tun>\n  \"1\\nip\"nonfree,free>\n  $(b8)\"2\\nB8(tcp)\"tun\n  free>\n  $(b8)\"2\\nB8(udp)\"tun:w\n  //Actual tunnel\n  tun<>\n  $(b8)\"3|6\\ntunnel\"native\ntun>$(b8)\"7\\nb8\"incoming>$(b8)\"8\\nb8\"tun>$(b8)\"9\\nip\"native\n\napp2>$(nt)\"d0\"native\napp1>$(b8)\"d0\"native\nnative>$(b8)\"10\\nr0\"app1\nnative>$(nt)\"8\\nr0\"app2\n}\n\nb8<>$(b8)\"4|5\\nvpn tunnel\"native\nb8<>remote\nnonfree>$(nt)\"6\"tun>$(nt)\"7\"native:e\nnonfree<>$(nt)\"2|5\\ntcp/ip \"native:ne\nnative<>$(nt)\"3|4\\ntcp/ip\"remote"}