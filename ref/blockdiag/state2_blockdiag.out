blockdiag{
 default_fontsize = 14
  orientation=landscape
  s[color="#ff0000"  ,shape="actor"];
  c[color="#0000ff"  ,shape="actor"];
  group "vpn connector"{
    color="#777777" 
    label="vpn connector" 
    m[color="#0000ff"  ,shape=box];
    vb[color="#0000ff"  ,shape=box];
    mo[color="#0000ff"  ,shape=box];
    b[color="#0000ff"  ,shape=box];
    v[color="#0000ff"  ,shape=box];
  }
  group "Phone state listener"{
    color="#33ff33" 
    label="Phone state listener" 
    e[color="#0000ff"  ,shape=box];
  }
  s -> c[label = "connect,s=red\nlink=green\n this node=blue" textcolor="#00ff00"   ,color="#00ff00"];
  c -> m[label = "turn off mobile data"];
  m -> vb[label = "create blackhole VPN"];
  vb -> mo[label = "turn on mobile data"];
  mo -> b[label = "do bootstrap"];
  b -> v[label = "connect vpn"];
  e -> s[label = "wifi connected"];
  e -> s[label = "wifi disconnected"];
  e -> s[label = "mobile connected"];
  e -> s[label = "mobile disconnected"];
}
